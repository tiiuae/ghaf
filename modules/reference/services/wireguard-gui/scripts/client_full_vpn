# SPDX-FileCopyrightText: 2022-2026 TII (SSRC) and the Ghaf contributors
# SPDX-License-Identifier: Apache-2.0
# This config enforces all the network traffic to go through WireGuard tunnel, except local network traffic (192.168.100.0/24,127.0.0.0/8)
PostUp =  iptables -I OUTPUT ! -o %i -m mark ! --mark $(wg show %i fwmark) -m addrtype ! --dst-type LOCAL -j REJECT; iptables -I OUTPUT -d 192.168.100.0/24 -j ACCEPT
PreDown =  iptables -D OUTPUT ! -o %i -m mark ! --mark $(wg show %i fwmark) -m addrtype ! --dst-type LOCAL -j REJECT; iptables -D OUTPUT -d 192.168.100.0/24 -j ACCEPT

FwMark = 0xaa
