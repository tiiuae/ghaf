<!-- --
Copyright 2020 Jorel Ali <contact@jorel.dev>
Copyright 2022-2024 TII (SSRC) and the Ghaf contributors
SPDX-License-Identifier: WTFPL
  ---->
<!DOCTYPE html>
<html
  lang="en"
  class="light"
  dir="ltr"
>
  <head>
    <!-- Book generated using mdBook -->
    <meta charset="UTF-8" />
    <title>systemd Service Hardening - Ghaf Framework</title>
 
    <!-- Custom HTML head -->
    
    <meta name="description" content="Documentation for TII SSRC Secure Technologies." />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#ffffff" />

    <link rel="icon" href="../favicon.svg" />
     
    <link rel="shortcut icon" href="../favicon.png" />
    <link rel="stylesheet" href="../css/variables.css" />
    <link rel="stylesheet" href="../css/general.css" />
    <link rel="stylesheet" href="../css/chrome.css" />
    <link
      rel="stylesheet"
      href="../css/print.css"
      media="print"
    />

    <!-- Fonts -->
    <link
      rel="stylesheet"
      href="../FontAwesome/css/font-awesome.css"
    />
    <link rel="stylesheet" href="../fonts/fonts.css" />

    <!-- Highlight.js Stylesheets -->
    <link rel="stylesheet" href="../highlight.css" />
    <link rel="stylesheet" href="../tomorrow-night.css" />
    <link rel="stylesheet" href="../ayu-highlight.css" />

    <!-- Custom theme stylesheets -->
    <link rel="stylesheet" href="../theme/pagetoc.css" />
       </head>
  <body class="sidebar-visible no-js">
    <div id="body-container">
      <!-- Provide site root to javascript -->
      <script>
        var path_to_root = "../";
        var default_theme = window.matchMedia("(prefers-color-scheme: dark)")
          .matches
          ? "navy"
          : "light";
      </script>

      <!-- Work around some values being stored in localStorage wrapped in quotes -->
      <script>
        try {
          var theme = localStorage.getItem("mdbook-theme");
          var sidebar = localStorage.getItem("mdbook-sidebar");

          if (theme.startsWith('"') && theme.endsWith('"')) {
            localStorage.setItem(
              "mdbook-theme",
              theme.slice(1, theme.length - 1),
            );
          }

          if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
            localStorage.setItem(
              "mdbook-sidebar",
              sidebar.slice(1, sidebar.length - 1),
            );
          }
        } catch (e) {}
      </script>

      <!-- Set the theme before any content is loaded, prevents flash -->
      <script>
        var theme;
        try {
          theme = localStorage.getItem("mdbook-theme");
        } catch (e) {}
        if (theme === null || theme === undefined) {
          theme = default_theme;
        }
        var html = document.querySelector("html");
        html.classList.remove("light");
        html.classList.add(theme);
        var body = document.querySelector("body");
        body.classList.remove("no-js");
        body.classList.add("js");
      </script>

      <input type="checkbox" id="sidebar-toggle-anchor" class="hidden" />

      <!-- Hide / unhide sidebar before it is displayed -->
      <script>
        var body = document.querySelector("body");
        var sidebar = null;
        var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
        if (document.body.clientWidth >= 1080) {
          try {
            sidebar = localStorage.getItem("mdbook-sidebar");
          } catch (e) {}
          sidebar = sidebar || "visible";
        } else {
          sidebar = "hidden";
        }
        sidebar_toggle.checked = sidebar === "visible";
        body.classList.remove("sidebar-visible");
        body.classList.add("sidebar-" + sidebar);
      </script>

      <nav id="sidebar" class="sidebar" aria-label="Table of contents">
        <div class="sidebar-scrollbox"><ol class="chapter"><li class="chapter-item expanded affix "><li class="part-title">Overview</li><li class="chapter-item expanded "><a href="../index.html"><strong aria-hidden="true">1.</strong> About Ghaf</a></li><li class="chapter-item expanded "><a href="../features/features.html"><strong aria-hidden="true">2.</strong> Features</a></li><li class="chapter-item expanded "><a href="../architecture/architecture.html"><strong aria-hidden="true">3.</strong> Architecture</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/variants.html"><strong aria-hidden="true">3.1.</strong> Architectural Variants</a></li><li class="chapter-item expanded "><a href="../architecture/adr.html"><strong aria-hidden="true">3.2.</strong> Architecture Decision Records</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../architecture/adr/minimal-host.html"><strong aria-hidden="true">3.2.1.</strong> Minimal Host</a></li><li class="chapter-item expanded "><a href="../architecture/adr/netvm.html"><strong aria-hidden="true">3.2.2.</strong> Networking VM</a></li><li class="chapter-item expanded "><a href="../architecture/adr/idsvm.html"><strong aria-hidden="true">3.2.3.</strong> Intrusion Detection System VM</a></li><li class="chapter-item expanded "><a href="../architecture/adr/platform-bus-passthrough-support.html"><strong aria-hidden="true">3.2.4.</strong> Platform Bus for Rust VMM</a></li></ol></li><li class="chapter-item expanded "><a href="../architecture/hardening.html"><strong aria-hidden="true">3.3.</strong> Hardening</a></li><li class="chapter-item expanded "><a href="../architecture/secureboot.html"><strong aria-hidden="true">3.4.</strong> Secure Boot</a></li><li class="chapter-item expanded "><a href="../architecture/stack.html"><strong aria-hidden="true">3.5.</strong> Stack</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">For Developers</li><li class="chapter-item expanded "><a href="../appendices/contributing_general.html"><strong aria-hidden="true">4.</strong> Contributing</a></li><li class="chapter-item expanded "><a href="../ref_impl/reference_implementations.html"><strong aria-hidden="true">5.</strong> Reference Implementations</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ref_impl/development.html"><strong aria-hidden="true">5.1.</strong> Development</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ref_impl/build_and_run.html"><strong aria-hidden="true">5.1.1.</strong> Build and Run</a></li><li class="chapter-item expanded "><a href="../ref_impl/remote_build_setup.html"><strong aria-hidden="true">5.1.2.</strong> Running Remote Build on NixOS</a></li><li class="chapter-item expanded "><a href="../ref_impl/installer.html"><strong aria-hidden="true">5.1.3.</strong> Installer</a></li><li class="chapter-item expanded "><a href="../ref_impl/cross_compilation.html"><strong aria-hidden="true">5.1.4.</strong> Cross-Compilation</a></li><li class="chapter-item expanded "><a href="../ref_impl/creating_appvm.html"><strong aria-hidden="true">5.1.5.</strong> Creating Application VM</a></li><li class="chapter-item expanded "><a href="../ref_impl/hw-config.html"><strong aria-hidden="true">5.1.6.</strong> Hardware Configuration</a></li><li class="chapter-item expanded "><a href="../ref_impl/profiles-config.html"><strong aria-hidden="true">5.1.7.</strong> Profiles Configuration</a></li><li class="chapter-item expanded "><a href="../ref_impl/labwc.html"><strong aria-hidden="true">5.1.8.</strong> labwc Desktop Environment</a></li><li class="chapter-item expanded "><a href="../ref_impl/idsvm-development.html"><strong aria-hidden="true">5.1.9.</strong> IDS VM Further Development</a></li><li class="chapter-item expanded "><a href="../ref_impl/systemd-service-config.html" class="active"><strong aria-hidden="true">5.1.10.</strong> systemd Service Hardening</a></li></ol></li><li class="chapter-item expanded "><a href="../troubleshooting/troubleshooting.html"><strong aria-hidden="true">5.2.</strong> Troubleshooting</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../troubleshooting/systemd/system-log.html"><strong aria-hidden="true">5.2.1.</strong> Analyzing System Logs</a></li><li class="chapter-item expanded "><a href="../troubleshooting/systemd/systemctl.html"><strong aria-hidden="true">5.2.2.</strong> Debugging systemd Using systemctl</a></li><li class="chapter-item expanded "><a href="../troubleshooting/systemd/systemd-analyzer.html"><strong aria-hidden="true">5.2.3.</strong> Inspecting Services with systemd-analyze</a></li><li class="chapter-item expanded "><a href="../troubleshooting/systemd/strace.html"><strong aria-hidden="true">5.2.4.</strong> Using strace for Debugging Initialization Sequence</a></li><li class="chapter-item expanded "><a href="../troubleshooting/systemd/early-shell.html"><strong aria-hidden="true">5.2.5.</strong> Early Shell Access</a></li></ol></li><li class="chapter-item expanded "><a href="../ref_impl/ghaf-based-project.html"><strong aria-hidden="true">5.3.</strong> Ghaf as Library: Templates</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../ref_impl/example_project.html"><strong aria-hidden="true">5.3.1.</strong> Example Project</a></li><li class="chapter-item expanded "><a href="../ref_impl/modules_options.html"><strong aria-hidden="true">5.3.2.</strong> Modules Options</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../technologies/technologies.html"><strong aria-hidden="true">6.</strong> Technologies</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../technologies/compartment.html"><strong aria-hidden="true">6.1.</strong> Compartmentalization</a></li><li class="chapter-item expanded "><a href="../technologies/passthrough.html"><strong aria-hidden="true">6.2.</strong> Passthrough</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../technologies/vfio.html"><strong aria-hidden="true">6.2.1.</strong> Binding Device to VFIO Driver</a></li><li class="chapter-item expanded "><a href="../technologies/nvidia_agx_pt_uart.html"><strong aria-hidden="true">6.2.2.</strong> NVIDIA Jetson AGX Orin: UART Passthrough</a></li><li class="chapter-item expanded "><a href="../technologies/nvidia_agx_pt_pcie.html"><strong aria-hidden="true">6.2.3.</strong> NVIDIA Jetson AGX Orin: PCIe Passthrough</a></li><li class="chapter-item expanded "><a href="../technologies/x86_pcie_crosvm.html"><strong aria-hidden="true">6.2.4.</strong> Generic x86: PCIe Passthrough on crosvm</a></li><li class="chapter-item expanded "><a href="../technologies/nvidia_uarti_net_vm.html"><strong aria-hidden="true">6.2.5.</strong> NVIDIA Jetson: UARTI Passthrough to netvm</a></li><li class="chapter-item expanded "><a href="../technologies/device_tree_overlays_pt.html"><strong aria-hidden="true">6.2.6.</strong> Device Tree Overlays for Passthrough</a></li></ol></li><li class="chapter-item expanded "><a href="../technologies/nvidia_virtualization_bpmp.html"><strong aria-hidden="true">6.3.</strong> Platform Bus Virtualization: NVIDIA BPMP</a></li><li class="chapter-item expanded "><a href="../technologies/hypervisor_options.html"><strong aria-hidden="true">6.4.</strong> Hypervisor Options</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Build System and Supply Chain</li><li class="chapter-item expanded "><a href="../scs/ci-cd-system.html"><strong aria-hidden="true">7.</strong> Continuous Integration and Distribution</a></li><li class="chapter-item expanded "><a href="../scs/scs.html"><strong aria-hidden="true">8.</strong> Supply Chain Security</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../scs/slsa-framework.html"><strong aria-hidden="true">8.1.</strong> SLSA Framework</a></li><li class="chapter-item expanded "><a href="../scs/basics.html"><strong aria-hidden="true">8.2.</strong> Basic Security Measures</a></li><li class="chapter-item expanded "><a href="../scs/sbom.html"><strong aria-hidden="true">8.3.</strong> Software Bill of Materials</a></li><li class="chapter-item expanded "><a href="../scs/pki.html"><strong aria-hidden="true">8.4.</strong> Public Key Infrastructure</a></li><li class="chapter-item expanded "><a href="../scs/ghaf-security-fix-automation.html"><strong aria-hidden="true">8.5.</strong> Security Fix Automation</a></li></ol></li><li class="chapter-item expanded "><a href="../release_notes/release_notes.html"><strong aria-hidden="true">9.</strong> Release Notes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../release_notes/ghaf-24.09.1.html"><strong aria-hidden="true">9.1.</strong> Release ghaf-24.09.1</a></li><li class="chapter-item expanded "><a href="../release_notes/ghaf-24.09.html"><strong aria-hidden="true">9.2.</strong> Release ghaf-24.09</a></li><li class="chapter-item expanded "><a href="../release_notes/ghaf-24.06.html"><strong aria-hidden="true">9.3.</strong> Release ghaf-24.06</a></li><li class="chapter-item expanded "><a href="../release_notes/ghaf-24.03.html"><strong aria-hidden="true">9.4.</strong> Release ghaf-24.03</a></li><li class="chapter-item expanded "><a href="../release_notes/ghaf-23.12.html"><strong aria-hidden="true">9.5.</strong> Release ghaf-23.12</a></li><li class="chapter-item expanded "><a href="../release_notes/ghaf-23.09.html"><strong aria-hidden="true">9.6.</strong> Release ghaf-23.09</a></li><li class="chapter-item expanded "><a href="../release_notes/ghaf-23.06.html"><strong aria-hidden="true">9.7.</strong> Release ghaf-23.06</a></li><li class="chapter-item expanded "><a href="../release_notes/ghaf-23.05.html"><strong aria-hidden="true">9.8.</strong> Release ghaf-23.05</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Ghaf Usage Scenarios</li><li class="chapter-item expanded "><a href="../scenarios/showcases.html"><strong aria-hidden="true">10.</strong> Showcases</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../scenarios/run_win_vm.html"><strong aria-hidden="true">10.1.</strong> Running Windows VM on Ghaf</a></li><li class="chapter-item expanded "><a href="../scenarios/run_cuttlefish.html"><strong aria-hidden="true">10.2.</strong> Running Cuttlefish on Ghaf</a></li></ol></li><li class="chapter-item expanded "><li class="spacer"></li><li class="chapter-item expanded affix "><li class="part-title">Appendices</li><li class="chapter-item expanded "><a href="../appendices/glossary.html"><strong aria-hidden="true">11.</strong> Glossary</a></li><li class="chapter-item expanded "><a href="../research/research.html"><strong aria-hidden="true">12.</strong> Research Notes</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../research/passthrough/ethernet.html"><strong aria-hidden="true">12.1.</strong> i.MX 8QM Ethernet Passthrough</a></li><li class="chapter-item expanded "><a href="../research/installation.html"><strong aria-hidden="true">12.2.</strong> System Installation</a></li></ol></li></ol></div>
        <div id="sidebar-resize-handle" class="sidebar-resize-handle">
          <div class="sidebar-resize-indicator"></div>
        </div>
      </nav>

      <!-- Track and set sidebar scroll position -->
      <script>
        var sidebarScrollbox = document.querySelector(
          "#sidebar .sidebar-scrollbox",
        );
        sidebarScrollbox.addEventListener(
          "click",
          function (e) {
            if (e.target.tagName === "A") {
              sessionStorage.setItem(
                "sidebar-scroll",
                sidebarScrollbox.scrollTop,
              );
            }
          },
          { passive: true },
        );
        var sidebarScrollTop = sessionStorage.getItem("sidebar-scroll");
        sessionStorage.removeItem("sidebar-scroll");
        if (sidebarScrollTop) {
          // preserve sidebar scroll position when navigating via links within sidebar
          sidebarScrollbox.scrollTop = sidebarScrollTop;
        } else {
          // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
          var activeSection = document.querySelector("#sidebar .active");
          if (activeSection) {
            activeSection.scrollIntoView({ block: "center" });
          }
        }
      </script>

      <div id="page-wrapper" class="page-wrapper">
        <div class="page">
                    <div id="menu-bar-hover-placeholder"></div>
          <div id="menu-bar" class="menu-bar sticky">
            <div class="left-buttons">
              <label
                id="sidebar-toggle"
                class="icon-button"
                for="sidebar-toggle-anchor"
                title="Toggle Table of Contents"
                aria-label="Toggle Table of Contents"
                aria-controls="sidebar"
              >
                <i class="fa fa-bars"></i>
              </label>
              <button
                id="theme-toggle"
                class="icon-button"
                type="button"
                title="Change theme"
                aria-label="Change theme"
                aria-haspopup="true"
                aria-expanded="false"
                aria-controls="theme-list"
              >
                <i class="fa fa-paint-brush"></i>
              </button>
              <ul
                id="theme-list"
                class="theme-popup"
                aria-label="Themes"
                role="menu"
              >
                <li role="none">
                  <button role="menuitem" class="theme" id="light">
                    Light
                  </button>
                </li>
                <li role="none">
                  <button role="menuitem" class="theme" id="rust">Rust</button>
                </li>
                <li role="none">
                  <button role="menuitem" class="theme" id="coal">Coal</button>
                </li>
                <li role="none">
                  <button role="menuitem" class="theme" id="navy">Navy</button>
                </li>
                <li role="none">
                  <button role="menuitem" class="theme" id="ayu">Ayu</button>
                </li>
              </ul>
              <button
                id="search-toggle"
                class="icon-button"
                type="button"
                title="Search. (Shortkey: s)"
                aria-label="Toggle Searchbar"
                aria-expanded="false"
                aria-keyshortcuts="S"
                aria-controls="searchbar"
              >
                <i class="fa fa-search"></i>
              </button>
            </div>

            <h1 class="menu-title">Ghaf Framework</h1>

            <div class="right-buttons">
              <a
                href="../print.html"
                title="Print this book"
                aria-label="Print this book"
              >
                <i id="print-button" class="fa fa-print"></i>
              </a>
               
              <a
                href="https://github.com/tiiuae/ghaf"
                title="Git repository"
                aria-label="Git repository"
              >
                <i
                  id="git-repository-button"
                  class="fa fa-github"
                ></i>
              </a>
                           </div>
          </div>

          <div id="search-wrapper" class="hidden">
            <form id="searchbar-outer" class="searchbar-outer">
              <input
                type="search"
                id="searchbar"
                name="searchbar"
                placeholder="Search this book ..."
                aria-controls="searchresults-outer"
                aria-describedby="searchresults-header"
              />
            </form>
            <div id="searchresults-outer" class="searchresults-outer hidden">
              <div id="searchresults-header" class="searchresults-header"></div>
              <ul id="searchresults"></ul>
            </div>
          </div>

          <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
          <script>
            document
              .getElementById("sidebar-toggle")
              .setAttribute("aria-expanded", sidebar === "visible");
            document
              .getElementById("sidebar")
              .setAttribute("aria-hidden", sidebar !== "visible");
            Array.from(document.querySelectorAll("#sidebar a")).forEach(
              function (link) {
                link.setAttribute("tabIndex", sidebar === "visible" ? 0 : -1);
              },
            );
          </script>

          <div id="content" class="content">
            <main>
              <div class="content-wrap"><style>
.mdbook-alerts {
  padding: 8px 16px;
  margin-bottom: 16px;
  border-left: 0.25em solid var(--mdbook-alerts-color);
}

.mdbook-alerts > *:first-child {
  margin-top: 0;
}

.mdbook-alerts > *:last-child {
  margin-bottom: 0;
}

.mdbook-alerts-title {
  display: flex;
  font-weight: 600;
  align-items: center;
  line-height: 1;
  color: var(--mdbook-alerts-color);
  text-transform: capitalize;
}

.mdbook-alerts-icon {
  display: inline-block;
  width: 1em;
  height: 1em;
  margin-right: 0.2em;
  background-color: currentColor;
  -webkit-mask: no-repeat center / 100%;
  mask: no-repeat center / 100%;
  -webkit-mask-image: var(--mdbook-alerts-icon);
  mask-image: var(--mdbook-alerts-icon);
}

.mdbook-alerts-note {
  --mdbook-alerts-color: rgb(9, 105, 218);
  /* https://icon-sets.iconify.design/material-symbols/info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16v-4q0-.425-.288-.712T12 11q-.425 0-.712.288T11 12v4q0 .425.288.713T12 17m0-8q.425 0 .713-.288T13 8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8q0 .425.288.713T12 9m0 13q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22m0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20m0-8"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-tip {
  --mdbook-alerts-color: rgb(26, 127, 55);
  /* https://icon-sets.iconify.design/material-symbols/lightbulb-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 22q-.825 0-1.412-.587T10 20h4q0 .825-.587 1.413T12 22m-3-3q-.425 0-.712-.288T8 18q0-.425.288-.712T9 17h6q.425 0 .713.288T16 18q0 .425-.288.713T15 19zm-.75-3q-1.725-1.025-2.738-2.75T4.5 9.5q0-3.125 2.188-5.312T12 2q3.125 0 5.313 2.188T19.5 9.5q0 2.025-1.012 3.75T15.75 16zm.6-2h6.3q1.125-.8 1.738-1.975T17.5 9.5q0-2.3-1.6-3.9T12 4Q9.7 4 8.1 5.6T6.5 9.5q0 1.35.613 2.525T8.85 14M12 14"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-important {
  --mdbook-alerts-color: rgb(130, 80, 223);
  /* https://icon-sets.iconify.design/material-symbols/chat-info-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 7q.425 0 .713-.288T13 6q0-.425-.288-.712T12 5q-.425 0-.712.288T11 6q0 .425.288.713T12 7m0 8q.425 0 .713-.288T13 14v-4q0-.425-.288-.712T12 9q-.425 0-.712.288T11 10v4q0 .425.288.713T12 15m-6 3l-2.3 2.3q-.475.475-1.088.213T2 19.575V4q0-.825.588-1.412T4 2h16q.825 0 1.413.588T22 4v12q0 .825-.587 1.413T20 18zm-.85-2H20V4H4v13.125zM4 16V4z"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-warning {
  --mdbook-alerts-color: rgb(154, 103, 0);
  /* https://icon-sets.iconify.design/material-symbols/warning-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M2.725 21q-.275 0-.5-.137t-.35-.363q-.125-.225-.137-.488t.137-.512l9.25-16q.15-.25.388-.375T12 3q.25 0 .488.125t.387.375l9.25 16q.15.25.138.513t-.138.487q-.125.225-.35.363t-.5.137zm1.725-2h15.1L12 6zM12 18q.425 0 .713-.288T13 17q0-.425-.288-.712T12 16q-.425 0-.712.288T11 17q0 .425.288.713T12 18m0-3q.425 0 .713-.288T13 14v-3q0-.425-.288-.712T12 10q-.425 0-.712.288T11 11v3q0 .425.288.713T12 15m0-2.5"%2F%3E%3C%2Fsvg%3E');
}

.mdbook-alerts-caution {
  --mdbook-alerts-color: rgb(207, 34, 46);
  /* https://icon-sets.iconify.design/material-symbols/brightness-alert-outline-rounded/ */
  --mdbook-alerts-icon: url('data:image/svg+xml,%3Csvg xmlns="http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg" width="24" height="24" viewBox="0 0 24 24"%3E%3Cpath fill="currentColor" d="M12 17q.425 0 .713-.288T13 16q0-.425-.288-.712T12 15q-.425 0-.712.288T11 16q0 .425.288.713T12 17m0-4q.425 0 .713-.288T13 12V8q0-.425-.288-.712T12 7q-.425 0-.712.288T11 8v4q0 .425.288.713T12 13m-3.35 7H6q-.825 0-1.412-.587T4 18v-2.65L2.075 13.4q-.275-.3-.425-.662T1.5 12q0-.375.15-.737t.425-.663L4 8.65V6q0-.825.588-1.412T6 4h2.65l1.95-1.925q.3-.275.663-.425T12 1.5q.375 0 .738.15t.662.425L15.35 4H18q.825 0 1.413.588T20 6v2.65l1.925 1.95q.275.3.425.663t.15.737q0 .375-.15.738t-.425.662L20 15.35V18q0 .825-.587 1.413T18 20h-2.65l-1.95 1.925q-.3.275-.662.425T12 22.5q-.375 0-.737-.15t-.663-.425zm.85-2l2.5 2.5l2.5-2.5H18v-3.5l2.5-2.5L18 9.5V6h-3.5L12 3.5L9.5 6H6v3.5L3.5 12L6 14.5V18zm2.5-6"%2F%3E%3C%2Fsvg%3E');
}

</style>
<!--
    Copyright 2022-2024 TII (SSRC) and the Ghaf contributors
    SPDX-License-Identifier: CC-BY-SA-4.0
-->
<h1 id="systemd-service-hardening"><a class="header" href="#systemd-service-hardening">systemd Service Hardening</a></h1>
<p>This document outlines systemd service configurations that significantly impact a service's exposure.</p>
<div class="mdbook-alerts mdbook-alerts-tip">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  tip
</p>
<p>For more information on troubleshooting common issues with systemd services, see <a href="/docs/src/troubleshooting/systemd/systemd_trblsh.html">Troubleshooting with systemd</a>.</p>
</div>
<p>The following configurations can be utilized to enhance the security of a systemd service:</p>
<table>
<tr>
</tr>
<tr>
<td>
<ol>
<li>Networking</li>
</ol>
<ul>
<li><a href="./systemd-service-config.html#11-privatenetwork">PrivateNetwork</a></li>
<li><a href="./systemd-service-config.html#12-ipaccounting">IPAccounting</a></li>
<li><a href="./systemd-service-config.html#13-ipaddressallow-ipaddressdeny">IPAddressAllow, IPAddressDeny</a></li>
<li><a href="./systemd-service-config.html#14-restrictnetworkinterfaces">RestrictNetworkInterfaces</a></li>
<li><a href="./systemd-service-config.html#15-restrictaddressfamilies">RestrictAddressFamilies</a></li>
</ul>
<ol start="2">
<li>File system</li>
</ol>
<ul>
<li><a href="./systemd-service-config.html#21-protecthome">ProtectHome</a></li>
<li><a href="./systemd-service-config.html#22-protectsystem">ProtectSystem</a></li>
<li><a href="./systemd-service-config.html#23-protectproc">ProtectProc</a></li>
<li><a href="./systemd-service-config.html#24-readwritepaths-readonlypaths-inaccessiblepaths-execpaths-noexecpaths">ReadWritePaths, ReadOnlyPaths, InaccessiblePaths, ExecPaths, NoExecPaths</a></li>
<li><a href="./systemd-service-config.html#25-privatetmp">PrivateTmp</a></li>
<li><a href="./systemd-service-config.html#26-privatemounts">PrivateMounts</a></li>
<li><a href="./systemd-service-config.html#27-procsubset">ProcSubset</a></li>
</ul>
<ol start="3">
<li>User separation</li>
</ol>
<ul>
<li><a href="./systemd-service-config.html#31-privateusers">PrivateUsers</a></li>
<li><a href="./systemd-service-config.html#32-dynamicuser">DynamicUser</a></li>
</ul>
<ol start="4">
<li>Devices</li>
</ol>
<ul>
<li><a href="./systemd-service-config.html#41-privatedevices">PrivateDevices</a></li>
<li><a href="./systemd-service-config.html#42-deviceallow">DeviceAllow</a></li>
</ul>
<ol start="5">
<li>Kernel</li>
</ol>
<ul>
<li><a href="./systemd-service-config.html#51-protectkerneltunables">ProtectKernelTunables</a></li>
<li><a href="./systemd-service-config.html#52-protectkernelmodules">ProtectKernelModules</a></li>
<li><a href="./systemd-service-config.html#53-protectkernellogs">ProtectKernelLogs</a></li>
</ul>
</td>
<td>
<ol start="6">
<li>Misc</li>
</ol>
<ul>
<li><a href="./systemd-service-config.html#61-delegate">Delegate</a></li>
<li><a href="./systemd-service-config.html#62-keyringmode">KeyringMode</a></li>
<li><a href="./systemd-service-config.html#63-nonewprivileges">NoNewPrivileges</a></li>
<li><a href="./systemd-service-config.html#64-umask">UMask</a></li>
<li><a href="./systemd-service-config.html#65-protecthostname">ProtectHostname</a></li>
<li><a href="./systemd-service-config.html#66-protectclock">ProtectClock</a></li>
<li><a href="./systemd-service-config.html#67-protectcontrolgroups">ProtectControlGroups</a></li>
<li><a href="./systemd-service-config.html#68-restrictnamespaces">RestrictNamespaces</a></li>
<li><a href="./systemd-service-config.html#69-lockpersonality">LockPersonality</a></li>
<li><a href="./systemd-service-config.html#610-memorydenywriteexecute">MemoryDenyWriteExecute</a></li>
<li><a href="./systemd-service-config.html#611-restrictrealtime">RestrictRealtime</a></li>
<li><a href="./systemd-service-config.html#612-restrictsuidsgid">RestrictSUIDSGID</a></li>
<li><a href="./systemd-service-config.html#613-removeipc">RemoveIPC</a></li>
<li><a href="./systemd-service-config.html#614-systemcallarchitectures">SystemCallArchitectures</a></li>
<li><a href="./systemd-service-config.html#615-notifyaccess">NotifyAccess</a></li>
</ul>
<ol start="7">
<li>Capabilities</li>
</ol>
<ul>
<li><a href="./systemd-service-config.html#71-ambientcapabilities">AmbientCapabilities</a></li>
<li><a href="./systemd-service-config.html#72-capabilityboundingset">CapabilityBoundingSet</a></li>
</ul>
<ol start="8">
<li>System calls</li>
</ol>
<ul>
<li><a href="./systemd-service-config.html#81-systemcallfilter">SystemCallFilter</a></li>
</ul>
</td>
</tr>
</table>
<hr />
<h2 id="1-networking"><a class="header" href="#1-networking">1. Networking</a></h2>
<h3 id="11-privatenetwork"><a class="header" href="#11-privatenetwork">1.1. PrivateNetwork</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#PrivateNetwork=">PrivateNetwork</a> is useful for preventing the service from accessing the network.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code><br />
<strong>Options</strong>:</p>
<ul>
<li><code>true</code> : Creates a new network namespace for the service. Only the loopback device "lo" is available in this namespace, other network devices are not accessible.</li>
<li><code>false</code> : The service will use the host's network namespace, it can access all the network devices available on the host. It can communicate over the network like any other process running on a host.</li>
</ul>
<h3 id="12-ipaccounting"><a class="header" href="#12-ipaccounting">1.2. IPAccounting</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html#IPAccounting=">IPAccounting</a> helps in detecting unusual or unexpected network activity by a service.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code><br />
<strong>Options</strong>:</p>
<ul>
<li><code>true</code>: Enables accounting for all IPv4 and IPv6 sockets created by the service: keeps track of the data sent and received by each socket in the service.</li>
<li><code>false</code>: Disables tracking of the sockets created by the service.</li>
</ul>
<h3 id="13-ipaddressallow-ipaddressdeny"><a class="header" href="#13-ipaddressallow-ipaddressdeny">1.3. IPAddressAllow, IPAddressDeny</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html#IPAddressAllow=">IPAddressAllow</a>=ADDRESS[/PREFIXLENGTH]…, IPAddressDeny=ADDRESS[/PREFIXLENGTH]…</p>
<p>Enables packet filtering on all IPv4 and IPv6 sockets created by the service. Useful for restricting/preventing a service from communicating only with certain IP addresses or networks.</p>
<p><strong>Type</strong>: <em>Space separated list of ip addresses and/or a symbolic name.</em><br />
<strong>Default</strong>: All IP addresses are allowed and no IP addresses are explicitly denied.<br />
<strong>Options</strong>:</p>
<ul>
<li><em>List of addresses</em>: Specify list of addresses allowed/denied. For example, <code>['192.168.1.8' '192.168.1.0/24']</code>. Any IP not explicitly allowed will be denied.</li>
<li><em>Symbolic Names</em>: Following symbolic names can also be used.<br />
<code>any</code> :	Any host (i.e., '0.0.0.0/0 ::/0').<br />
<code>localhost</code>: All addresses on the local loopback (i.e., '127.0.0.0/8 ::1/128').<br />
<code>link-local</code>: All link-local IP addresses(i.e., '169.254.0.0/16 fe80::/64').<br />
<code>multicast</code>: All IP multicasting addresses (i.e., 224.0.0.0/4 ff00::/8).</li>
</ul>
<h3 id="14-restrictnetworkinterfaces"><a class="header" href="#14-restrictnetworkinterfaces">1.4. RestrictNetworkInterfaces</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html#RestrictNetworkInterfaces=">RestrictNetworkInterfaces</a> is used to control which network interfaces a service has access to. This helps isolate services from the network or restrict them to specific network interfaces, enhancing security and reducing potential risk.</p>
<p><strong>Type</strong>: <em>Space-separated list of network interface names.</em><br />
<strong>Default</strong>: The service can access to all available network interfaces unless other network restrictions are in place.<br />
<strong>Options</strong>:</p>
<ul>
<li>Specify individual network interface names to restrict the service to using only those interfaces.</li>
<li>Prefix an interface name with '~' to invert the restriction, i.e. denying access to that specific interface while allowing all others.</li>
</ul>
<h3 id="15-restrictaddressfamilies"><a class="header" href="#15-restrictaddressfamilies">1.5. RestrictAddressFamilies</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#RestrictAddressFamilies=">RestrictAddressFamilies</a> is used to control which address families a service can use. This setting restricts the service's ability to open sockets using specific address families, such as <code>'AF_INET'</code> for IPv4, <code>'AF_INET6'</code> for IPv6, or others. It is a security feature that helps limit the service's network capabilities and reduces its exposure to network-related vulnerabilities.</p>
<p><strong>Type</strong>: List of address family names.<br />
<strong>Default</strong>: If not configured, the service is allowed to use all available address families.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>none</code></strong>: Apply no restriction.</li>
<li><strong>Specific Address Families</strong>: Specify one or more address families that the service is allowed to use, for example, <code>'AF_INET'</code>, <code>'AF_INET6'</code>, <code>'AF_UNIX'</code>.</li>
<li><strong>Inverted Restriction</strong>: Prepend character '~' to an address family name to deny access to it while allowing all others, for example, <code>'~AF_INET'</code> would block IPv4 access.</li>
</ul>
<h2 id="back-to-top-"><a class="header" href="#back-to-top-"><a href="./systemd-service-config.html#systemd-service-hardening">Back to Top ⏫</a></a></h2>
<h2 id="2-file-system"><a class="header" href="#2-file-system">2. File System</a></h2>
<h3 id="21-protecthome"><a class="header" href="#21-protecthome">2.1 ProtectHome</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectHome=">ProtectHome</a> is used to restrict a service's access to home directories. This security feature can be used either completely to block access to <code>/home</code>, <code>/root</code>, and <code>/run/user</code> or make them appear empty to the service, thereby protecting user data from unauthorized access by system services.</p>
<p><strong>Type</strong>: <em>Boolean or String.</em><br />
<strong>Default</strong>: <code>false</code> i.e. the service has full access to home directories unless restricted by some other mean.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: The service is completely denied access to home directories.</li>
<li><strong><code>false</code></strong>: The service has unrestricted access to home directories.</li>
<li><strong><code>read-only</code></strong>: The service can view the contents of home directories but cannot modify them.</li>
<li><strong><code>tmpfs</code></strong>: Mounts a temporary filesystem in place of home directories, ensuring the service cannot access or modify the actual user data. Adding the tmpfs option provides a flexible approach by creating a volatile in-memory filesystem where the service believes it has access to home but any changes it makes do not affect the actual data and are lost when the service stops. This is particularly useful for services that require a temporary space in a home.</li>
</ul>
<h3 id="22-protectsystem"><a class="header" href="#22-protectsystem">2.2. ProtectSystem</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectSystem=">ProtectSystem</a> controls access to the system's root directory (<code>/</code>) and other essential system directories. This setting enhances security by restricting a service's ability to modify or access critical system files and directories.</p>
<p><strong>Type</strong>: <em>Boolean or String.</em><br />
<strong>Default</strong>: <code>full</code> (Equivalent to <code>true</code>). The service is restricted from modifying or accessing critical system directories.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Mounts the directories <code>/usr/</code>, <code>/boot</code>, and <code>/efi</code> read-only for processes.</li>
<li><strong><code>full</code></strong>: Additionally mounts the <code>/etc/</code> directory read-only.</li>
<li><strong><code>strict</code></strong>: Mounts the entire file system hierarchy read-only, except for essential API file system subtrees like <code>/dev/</code>, <code>/proc/</code>, and <code>/sys/</code>.</li>
<li><strong><code>false</code></strong>: Allows the service unrestricted access to system directories.</li>
</ul>
<p>Using <code>true</code> or <code>full</code> is recommended for services that do not require access to system directories to enhance security and stability.</p>
<h3 id="23-protectproc"><a class="header" href="#23-protectproc">2.3. ProtectProc</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectProc=">ProtectProc</a> controls access to the <code>/proc</code> filesystem for a service. This setting enhances security by restricting a service's ability to view or manipulate processes and kernel information in the <code>/proc</code> directory.</p>
<p><strong>Type</strong>: <em>Boolean or String.</em><br />
<strong>Default</strong>: <code>default</code>. No restriction is imposed from viewing or manipulating processes and kernel information in <code>/proc</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>noaccess</code></strong>: Restricts access to most process metadata of other users in <code>/proc</code>.</li>
<li><strong><code>invisible</code></strong>: Hides processes owned by other users from view in <code>/proc</code>.</li>
<li><strong><code>ptraceable</code></strong>: Hides processes that cannot be traced (<code>ptrace()</code>) by other processes.</li>
<li><strong><code>default</code></strong>: Imposes no restrictions on access or visibility to <code>/proc</code>.</li>
</ul>
<h3 id="24-readwritepaths-readonlypaths-inaccessiblepaths-execpaths-noexecpaths"><a class="header" href="#24-readwritepaths-readonlypaths-inaccessiblepaths-execpaths-noexecpaths">2.4. ReadWritePaths, ReadOnlyPaths, InaccessiblePaths, ExecPaths, NoExecPaths</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ReadWritePaths=">ReadWritePaths</a> creates a new file system namespace for executed processes, enabling fine-grained control over file system access.</p>
<ul>
<li><strong>ReadWritePaths=</strong>: Paths listed here are accessible with the same access modes from within the namespace as from outside it.</li>
<li><strong>ReadOnlyPaths=</strong>: Allows reading from listed paths only; write attempts are refused even if file access controls would otherwise permit it.</li>
<li><strong>InaccessiblePaths=</strong>: Makes listed paths and everything below them in the file system hierarchy inaccessible to processes within the namespace.</li>
<li><strong>NoExecPaths=</strong>: Prevents execution of files from listed paths, overriding usual file access controls. Nest <code>ExecPaths=</code> within <code>NoExecPaths=</code> to selectively allow execution within directories otherwise marked non-executable.</li>
</ul>
<p><strong>Type</strong>: <em>Space-separated list of paths.</em><br />
<strong>Default</strong>: No restriction to file system access until unless restricted by some other mechanism.<br />
<strong>Options</strong>:<br />
<strong>Space separated list of paths</strong> : Space-separated list of paths relative to the host's root directory. Symlinks are resolved relative to the root directory specified by <code>RootDirectory=</code> or <code>RootImage=</code>.</p>
<h3 id="25-privatetmp"><a class="header" href="#25-privatetmp">2.5. PrivateTmp</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#PrivateTmp=">PrivateTmp</a> uses a private, isolated <code>/tmp</code> directory for the service, enhancing security by preventing access to other processes' temporary files and ensuring data isolation.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>. If not specified, the service shares the system <code>/tmp</code> directory with other processes.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Enables private <code>/tmp</code> for the service, isolating its temporary files from other processes.</li>
<li><strong><code>false</code></strong>: The service shares the system <code>/tmp</code> directory with other processes.</li>
</ul>
<p>Additionally, when enabled, all temporary files created by a service in these directories will be automatically removed after the service is stopped.</p>
<h3 id="26-privatemounts"><a class="header" href="#26-privatemounts">2.6. PrivateMounts</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#PrivateMounts=">PrivateMounts</a> controls whether the service should have its mount namespace, isolating its mounts from the rest of the system. This setup ensures that any file system mount points created or removed by the unit's processes remain private to them and are not visible to the host.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>. If not specified, the service shares the same mount namespace as other processes.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Enables private mount namespace for the service, isolating its mounts from the rest of the system.</li>
<li><strong><code>false</code></strong>: The service shares the same mount namespace as other processes.</li>
</ul>
<h3 id="27-procsubset"><a class="header" href="#27-procsubset">2.7. ProcSubset</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProcSubset=">ProcSubset</a> restricts the set of <code>/proc</code> entries visible to the service, enhancing security by limiting access to specific process information in the <code>/proc</code> filesystem.</p>
<p><strong>Type</strong>: <em>String.</em><br />
<strong>Default</strong>: <code>all</code>. If not specified, the service has access to all <code>/proc</code> entries.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>all</code></strong>: Allows the service access to all <code>/proc</code> entries.</li>
<li><strong><code>pid</code></strong>: Restricts the service to only its own process information (<code>/proc/self</code>, <code>/proc/thread-self/</code>).</li>
</ul>
<h2 id="back-to-top--1"><a class="header" href="#back-to-top--1"><a href="./systemd-service-config.html#systemd-service-hardening">Back to Top ⏫</a></a></h2>
<h2 id="3-user-separation"><a class="header" href="#3-user-separation">3. User Separation</a></h2>
<div class="mdbook-alerts mdbook-alerts-important">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  important
</p>
<p>Not applicable for the service runs as root.</p>
</div>
<h3 id="31-privateusers"><a class="header" href="#31-privateusers">3.1. PrivateUsers</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#PrivateUsers=">PrivateUsers=</a> controls whether the service should run with a private set of UIDs and GIDs, isolating the user and group databases used by the unit from the rest of the system, and creating a secure sandbox environment. The isolation reduces the privilege escalation potential of services.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>. If not specified, the service runs with the same user and group IDs as other processes.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Enables private user and group IDs for the service by creating a new user namespace, isolating them from the rest of the system.</li>
<li><strong><code>false</code></strong>: The service runs with the same user and group IDs as other processes.</li>
</ul>
<h3 id="32-dynamicuser"><a class="header" href="#32-dynamicuser">3.2. DynamicUser</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#DynamicUser=">DynamicUser</a> enables systemd to dynamically allocate a unique user and group ID (UID/GID) for the service at runtime, enhancing security and resource isolation. These user and group entries are managed transiently during runtime and are not added to <code>/etc/passwd</code> or <code>/etc/group</code>.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>. If not specified, the service uses a static user and group ID defined in the service unit file or defaults to <code>root</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: A UNIX user and group pair are dynamically allocated when the unit is started and released as soon as it is stopped.</li>
<li><strong><code>false</code></strong>: The service uses a static UID/GID defined in the service unit file or defaults to <code>root</code>.</li>
</ul>
<h2 id="back-to-top--2"><a class="header" href="#back-to-top--2"><a href="./systemd-service-config.html#systemd-service-hardening">Back to Top ⏫</a></a></h2>
<h2 id="4-devices"><a class="header" href="#4-devices">4. Devices</a></h2>
<h3 id="41-privatedevices"><a class="header" href="#41-privatedevices">4.1. PrivateDevices</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#PrivateDevices=">PrivateDevices</a> controls whether the service should have access to device nodes in <code>/dev</code>.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>. If not specified, the service has access to device nodes in <code>/dev</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Restricts the service's access to device nodes in <code>/dev</code> by creating a new <code>/dev/</code> mount for the executed processes and includes only pseudo devices such as <code>/dev/null</code>, <code>/dev/zero</code>, or <code>/dev/random</code>. Physical devices are not added to this mount. This setup is useful for disabling physical device access by the service.</li>
<li><strong><code>false</code></strong>: The service has access to device nodes in <code>/dev</code>.</li>
</ul>
<h3 id="42-deviceallow"><a class="header" href="#42-deviceallow">4.2. DeviceAllow</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html#DeviceAllow=">DeviceAllow</a> specifies individual device access rules for the service, allowing fine-grained control over device permissions.</p>
<p><strong>Type</strong>: <em>Space-separated list of device access rules.</em><br />
<strong>Default</strong>: None. If not specified, the service does not have specific device access rules defined.<br />
<strong>Options</strong>:</p>
<ul>
<li>Specify device access rules in the format: <code>&lt;device path&gt; &lt;permission&gt;</code> where <code>&lt;permission&gt;</code> can be <code>r</code> (read), <code>w</code> (write), or <code>m</code> (mknod, allowing creation of devices).</li>
</ul>
<h2 id="back-to-top--3"><a class="header" href="#back-to-top--3"><a href="./systemd-service-config.html#systemd-service-hardening">Back to Top ⏫</a></a></h2>
<h2 id="5-kernel"><a class="header" href="#5-kernel">5. Kernel</a></h2>
<h3 id="51-protectkerneltunables"><a class="header" href="#51-protectkerneltunables">5.1. ProtectKernelTunables</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectKernelTunables=">ProtectKernelTunables</a> controls whether the service is allowed to modify tunable kernel variables in <code>/proc/sys</code>, enhancing security by restricting access to critical kernel parameters.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>true</code>. If not specified, the service is restricted from modifying kernel variables.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Restricts the service from modifying the kernel variables accessible through paths like <code>/proc/sys/</code>, <code>/sys/</code>, <code>/proc/sysrq-trigger</code>, <code>/proc/latency_stats</code>, <code>/proc/acpi</code>, <code>/proc/timer_stats</code>, <code>/proc/fs</code>, and <code>/proc/irq</code>. These paths are made read-only to all processes of the unit.</li>
<li><strong><code>false</code></strong>: Allows the service to modify tunable kernel variables.</li>
</ul>
<h3 id="52-protectkernelmodules"><a class="header" href="#52-protectkernelmodules">5.2. ProtectKernelModules</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectKernelModules=">ProtectKernelModules</a> controls whether the service is allowed to load or unload kernel modules, enhancing security by restricting module management capabilities.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>true</code>. If not specified, the service is restricted from loading or unloading kernel modules.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Restricts the service from loading or unloading kernel modules. It removes <code>CAP_SYS_MODULE</code> from the capability bounding set for the unit and installs a system call filter to block module system calls. <code>/usr/lib/modules</code> is also made inaccessible.</li>
<li><strong><code>false</code></strong>: Allows the service to load or unload kernel modules in a modular kernel.</li>
</ul>
<h3 id="53-protectkernellogs"><a class="header" href="#53-protectkernellogs">5.3. ProtectKernelLogs</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectKernelLogs=">ProtectKernelLogs</a> controls whether the service is allowed to access kernel log messages, enhancing security by restricting access to kernel logs.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>. If not specified, the service is allowed to access kernel logs.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>trues</code></strong>: Restricts the service from accessing kernel logs from <code>/proc/kmsg</code> and <code>/dev/kmsg</code>. Enabling this option removes <code>CAP_SYSLOG</code> from the capability bounding set for the unit and installs a system call filter to block the syslog(2) system call.</li>
<li><strong><code>no</code></strong>: Allows the service to access kernel logs.</li>
</ul>
<h2 id="back-to-top--4"><a class="header" href="#back-to-top--4"><a href="./systemd-service-config.html#systemd-service-hardening">Back to Top ⏫</a></a></h2>
<h2 id="6-misc"><a class="header" href="#6-misc">6. Misc</a></h2>
<h3 id="61-delegate"><a class="header" href="#61-delegate">6.1. Delegate</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.resource-control.html#Delegate=">Delegate</a> controls whether systemd should delegate further control of resource management to the service's own resource management settings.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>true</code>. If not specified, systemd delegates control to the service's resource management settings.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Enables delegation and activates all supported controllers for the unit, allowing its processes to manage them.</li>
<li><strong><code>false</code></strong>: Disables delegation entirely. Systemd retains control over resource management, potentially overriding the service's settings.</li>
</ul>
<h3 id="62-keyringmode"><a class="header" href="#62-keyringmode">6.2. KeyringMode</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#KeyringMode=">KeyringMode</a> specifies the handling mode for session keyrings by the service, controlling how it manages encryption keys and credentials.</p>
<p><strong>Type</strong>: <em>String.</em><br />
<strong>Default</strong>: <code>private</code>. If not specified, the service manages its session keyrings privately.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>private</code></strong>: The service manages its session keyrings privately.</li>
<li><strong><code>shared</code></strong>: The service shares its session keyrings with other services and processes.</li>
<li><strong><code>inherit</code></strong>: The service inherits session keyrings from its parent process or environment.</li>
</ul>
<h3 id="63-nonewprivileges"><a class="header" href="#63-nonewprivileges">6.3. NoNewPrivileges</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#NoNewPrivileges=">NoNewPrivileges</a> controls whether the service and its children processes are allowed to gain new privileges (capabilities).</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>. If not specified, the service and its children's processes can gain new privileges.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Prevents the service and its children processes from gaining new privileges.</li>
<li><strong><code>false</code></strong>: Allows the service and its children processes to gain new privileges.</li>
</ul>
<div class="mdbook-alerts mdbook-alerts-important">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  important
</p>
<p>Some configurations may override this setting and ignore its value.</p>
</div>
<h3 id="64-umask"><a class="header" href="#64-umask">6.4. UMask</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#UMask=">UMask</a>
sets the file mode creation mask (umask) for the service, controlling the default permissions applied to newly created files and directories.</p>
<p><strong>Type</strong>: <em>Octal numeric value.</em><br />
<strong>Default</strong>:  If not specified, inherits the default umask of the systemd service manager(0022).<br />
<strong>Example</strong>: <code>UMask=027</code>.</p>
<h3 id="65-protecthostname"><a class="header" href="#65-protecthostname">6.5. ProtectHostname</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectHostname=">ProtectHostname</a> controls whether the service can modify its own hostname.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Sets up a new UTS namespace for the executed processes. It prevents changes to the hostname or domainname.</li>
<li><strong><code>false</code></strong>: Allows the service to modify its own hostname.</li>
</ul>
<h3 id="66-protectclock"><a class="header" href="#66-protectclock">6.6. ProtectClock</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectClock=">ProtectClock</a> controls whether the service is allowed to manipulate the system clock.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Prevents the service from manipulating the system clock. It removes <code>CAP_SYS_TIME</code> and <code>CAP_WAKE_ALARM</code> from the capability bounding set for this unit. Also creates a system call filter to block calls that can manipulate the system clock.</li>
<li><strong><code>false</code></strong>: Allows the service to manipulate the system clock.</li>
</ul>
<h3 id="67-protectcontrolgroups"><a class="header" href="#67-protectcontrolgroups">6.7. ProtectControlGroups</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#ProtectControlGroups=">ProtectControlGroups</a> controls whether the service is allowed to modify control groups (cgroups) settings.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Prevents the service from modifying cgroups settings. Makes the Linux Control Groups (cgroups(7)) hierarchies accessible through <code>/sys/fs/cgroup/</code> read-only to all processes of the unit.</li>
<li><strong><code>false</code></strong>: Allows the service to modify cgroups settings.</li>
</ul>
<h3 id="68-restrictnamespaces"><a class="header" href="#68-restrictnamespaces">6.8. RestrictNamespaces</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#RestrictNamespaces=">RestrictNamespaces</a> controls the namespace isolation settings for the service, restricting or allowing namespace access.</p>
<p><strong>Type</strong>: <em>Boolean</em> or <em>space-separated list of namespace type identifiers</em>.
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><code>false</code>: No restrictions on namespace creation and switching are imposed.</li>
<li><code>true</code>: Prohibits access to any kind of namespacing.</li>
<li>Otherwise: Specifies a space-separated list of namespace type identifiers, which can include <code>cgroup</code>, <code>ipc</code>, <code>net</code>, <code>mnt</code>, <code>pid</code>, <code>user</code>, and <code>uts</code>. When the namespace identifier is prefixed with '~', it inverts the action.</li>
</ul>
<h3 id="69-lockpersonality"><a class="header" href="#69-lockpersonality">6.9. LockPersonality</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#LockPersonality=">LockPersonality</a> applies restriction on the service's ability to change its execution personality.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Prevents the service from changing its execution personality. If the service runs in user mode or in system mode without the <code>CAP_SYS_ADMIN</code> capability (e.g., setting <code>User=</code>), enabling this option implies <code>NoNewPrivileges=yes</code>.</li>
<li><strong><code>false</code></strong>: Allows the service to change its execution personality.</li>
</ul>
<h3 id="610-memorydenywriteexecute"><a class="header" href="#610-memorydenywriteexecute">6.10. MemoryDenyWriteExecute</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#MemoryDenyWriteExecute=">MemoryDenyWriteExecute</a> controls whether the service is allowed to execute code from writable memory pages.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Prohibits attempts to create memory mappings that are writable and executable simultaneously, change existing memory mappings to become executable, or map shared memory segments as executable. This restriction is implemented by adding an appropriate system call filter.</li>
<li><strong><code>false</code></strong>: Allows the service to execute code from writable memory pages.</li>
</ul>
<h3 id="611-restrictrealtime"><a class="header" href="#611-restrictrealtime">6.11. RestrictRealtime</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#RestrictRealtime=">RestrictRealtime</a> controls whether the service is allowed to utilize real-time scheduling policies.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Prevents the service from utilizing real-time scheduling policies. Refuses any attempts to enable realtime scheduling in processes of the unit. This restriction prevents access to realtime task scheduling policies such as <code>SCHED_FIFO</code>, <code>SCHED_RR</code>, or <code>SCHED_DEADLINE</code>.</li>
<li><strong><code>false</code></strong>: Allows the service to utilize real-time scheduling policies.</li>
</ul>
<h3 id="612-restrictsuidsgid"><a class="header" href="#612-restrictsuidsgid">6.12. RestrictSUIDSGID</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#RestrictSUIDSGID=">RestrictSUIDSGID</a> controls whether the service is allowed to execute processes with SUID and SGID privileges.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Prevents the service from executing processes with SUID and SGID privileges. Denies any attempts to set the set-user-ID (SUID) or set-group-ID (SGID) bits on files or directories. These bits are used to elevate privileges and allow users to acquire the identity of other users.</li>
<li><strong><code>false</code></strong>: Allows the service to execute processes with SUID and SGID privileges.</li>
</ul>
<h3 id="613-removeipc"><a class="header" href="#613-removeipc">6.13. RemoveIPC</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#RemoveIPC=">RemoveIPC</a> controls whether to remove inter-process communication (IPC) resources associated with the service upon its termination.</p>
<p><strong>Type</strong>: <em>Boolean.</em><br />
<strong>Default</strong>: <code>false</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><strong><code>true</code></strong>: Removes IPC resources (<strong>System V</strong> and <strong>POSIX IPC</strong> objects) associated with the service upon its termination. This includes IPC objects such as message queues, semaphore sets, and shared memory segments.</li>
<li><strong><code>false</code></strong>: Retains IPC resources associated with the service after its termination.</li>
</ul>
<h3 id="614-systemcallarchitectures"><a class="header" href="#614-systemcallarchitectures">6.14. SystemCallArchitectures</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#SystemCallArchitectures=">SystemCallArchitectures</a> specifies the allowed system call architectures for the service to include in system call filter.</p>
<p><strong>Type</strong>: <em>Space-separated list of architecture identifiers.</em><br />
<strong>Default</strong>: Empty list. No filtering is applied.<br />
<strong>Options</strong>:</p>
<ul>
<li><em>List of architectures</em>: Processes of this unit will only be allowed to call native system calls and system calls specific to the architectures specified in the list. e.g. <code>native</code>, <code>x86</code>, <code>x86-64</code> or <code>arm64</code> etc.</li>
</ul>
<h3 id="615-notifyaccess"><a class="header" href="#615-notifyaccess">6.15. NotifyAccess</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/latest/systemd.service.html#NotifyAccess=">NotifyAccess</a> specifies how the service can send service readiness notification signals.</p>
<p><strong>Type</strong>: <em>Access specifier string.</em><br />
<strong>Default</strong>: <code>none</code>.<br />
<strong>Options</strong>:</p>
<ul>
<li><code>none</code> (default): No daemon status updates are accepted from the service processes; all status update messages are ignored.</li>
<li><code>main</code>: Allows sending signals using the main process identifier (PID).</li>
<li><code>exec</code>: Only service updates sent from any main or control processes originating from one of the <code>Exec*=</code> commands are accepted.</li>
<li><code>all</code>: Allows sending signals using any process identifier (PID).</li>
</ul>
<h2 id="back-to-top--5"><a class="header" href="#back-to-top--5"><a href="./systemd-service-config.html#systemd-service-hardening">Back to Top ⏫</a></a></h2>
<h2 id="7-capabilities"><a class="header" href="#7-capabilities">7. Capabilities</a></h2>
<h3 id="71-ambientcapabilities"><a class="header" href="#71-ambientcapabilities">7.1. AmbientCapabilities</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#AmbientCapabilities=">AmbientCapabilities</a> specifies which capabilities to include in the ambient capability set for the service, which are inherited by all processes within the service.</p>
<p><strong>Type</strong>: <em>Space-separated list of capabilities.</em><br />
<strong>Default</strong>: Processes inherit ambient capabilities from their parent process or the systemd service manager unless explicitly set.<br />
<strong>Options</strong>:</p>
<ul>
<li><em>List of capabilities</em>: Specifies the capabilities that are set as ambient for all processes within the service.</li>
</ul>
<p>This option can be specified multiple times to merge capability sets:</p>
<ul>
<li>If capabilities are listed without a prefix, those capabilities are included in the ambient capability set.</li>
<li>If capabilities are prefixed with "~", all capabilities except those listed are included (inverted effect).</li>
<li>Assigning the empty string (<code>""</code>) resets the ambient capability set to empty, overriding all prior settings.</li>
</ul>
<h3 id="72-capabilityboundingset"><a class="header" href="#72-capabilityboundingset">7.2. CapabilityBoundingSet</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#CapabilityBoundingSet=">CapabilityBoundingSet</a> specifies the bounding set of capabilities for the service, limiting the capabilities available to processes within the service.</p>
<p><strong>Type</strong>: <em>Space-separated list of capabilities.</em><br />
<strong>Default</strong>: If not explicitly specified, the bounding set of capabilities is determined by systemd defaults or the system configuration.<br />
<strong>Options</strong>:</p>
<ul>
<li><em>List of capabilities</em>: Specifies the capabilities that are allowed for processes within the service. If capabilities are prefixed with "~", all capabilities except those listed are included (inverted effect).</li>
</ul>
<div class="table-wrapper"><table><thead><tr><th><strong>Capability</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td><strong>CAP_AUDIT_CONTROL</strong></td><td>Allows processes to control kernel auditing behavior, including enabling and disabling auditing, and changing audit rules.</td></tr>
<tr><td><strong>CAP_AUDIT_READ</strong></td><td>Allows processes to read audit log via unicast netlink socket.</td></tr>
<tr><td><strong>CAP_AUDIT_WRITE</strong></td><td>Allows processes to write records to kernel auditing log.</td></tr>
<tr><td><strong>CAP_BLOCK_SUSPEND</strong></td><td>Allows processes to prevent the system from entering suspend mode.</td></tr>
<tr><td><strong>CAP_CHOWN</strong></td><td>Allows processes to change the ownership of files.</td></tr>
<tr><td><strong>CAP_DAC_OVERRIDE</strong></td><td>Allows processes to bypass file read, write, and execute permission checks.</td></tr>
<tr><td><strong>CAP_DAC_READ_SEARCH</strong></td><td>Allows processes to bypass file read permission checks and directory read and execute permission checks.</td></tr>
<tr><td><strong>CAP_FOWNER</strong></td><td>Allows processes to bypass permission checks on operations that normally require the filesystem UID of the file to match the calling process's UID.</td></tr>
<tr><td><strong>CAP_FSETID</strong></td><td>Allows processes to set arbitrary process and file capabilities.</td></tr>
<tr><td><strong>CAP_IPC_LOCK</strong></td><td>Allows processes to lock memory segments into RAM.</td></tr>
<tr><td><strong>CAP_IPC_OWNER</strong></td><td>Allows processes to perform various System V IPC operations, such as message queue management and shared memory management.</td></tr>
<tr><td><strong>CAP_KILL</strong></td><td>Allows processes to send signals to arbitrary processes.</td></tr>
<tr><td><strong>CAP_LEASE</strong></td><td>Allows processes to establish leases on open files.</td></tr>
<tr><td><strong>CAP_LINUX_IMMUTABLE</strong></td><td>Allows processes to modify the immutable and append-only flags of files.</td></tr>
<tr><td><strong>CAP_MAC_ADMIN</strong></td><td>Allows processes to perform MAC configuration changes.</td></tr>
<tr><td><strong>CAP_MAC_OVERRIDE</strong></td><td>Bypasses Mandatory Access Control (MAC) policies.</td></tr>
<tr><td><strong>CAP_MKNOD</strong></td><td>Allows processes to create special files using mknod().</td></tr>
<tr><td><strong>CAP_NET_ADMIN</strong></td><td>Allows processes to perform network administration tasks, such as configuring network interfaces, setting routing tables, etc.</td></tr>
<tr><td><strong>CAP_NET_BIND_SERVICE</strong></td><td>Allows processes to bind to privileged ports (ports below 1024).</td></tr>
<tr><td><strong>CAP_NET_BROADCAST</strong></td><td>Allows processes to transmit packets to broadcast addresses.</td></tr>
<tr><td><strong>CAP_NET_RAW</strong></td><td>Allows processes to use raw and packet sockets.</td></tr>
<tr><td><strong>CAP_SETGID</strong></td><td>Allows processes to change their GID to any value.</td></tr>
<tr><td><strong>CAP_SETFCAP</strong></td><td>Allows processes to set any file capabilities.</td></tr>
<tr><td><strong>CAP_SETPCAP</strong></td><td>Allows processes to set the capabilities of other processes.</td></tr>
<tr><td><strong>CAP_SETUID</strong></td><td>Allows processes to change their UID to any value.</td></tr>
<tr><td><strong>CAP_SYS_ADMIN</strong></td><td>Allows processes to perform a range of system administration tasks, such as mounting filesystems, configuring network interfaces, loading kernel modules, etc.</td></tr>
<tr><td><strong>CAP_SYS_BOOT</strong></td><td>Allows processes to reboot or shut down the system.</td></tr>
<tr><td><strong>CAP_SYS_CHROOT</strong></td><td>Allows processes to use chroot().</td></tr>
<tr><td><strong>CAP_SYS_MODULE</strong></td><td>Allows processes to load and unload kernel modules.</td></tr>
<tr><td><strong>CAP_SYS_NICE</strong></td><td>Allows processes to increase their scheduling priority.</td></tr>
<tr><td><strong>CAP_SYS_PACCT</strong></td><td>Allows processes to configure process accounting.</td></tr>
<tr><td><strong>CAP_SYS_PTRACE</strong></td><td>Allows processes to trace arbitrary processes using ptrace().</td></tr>
<tr><td><strong>CAP_SYS_RAWIO</strong></td><td>Allows processes to perform I/O operations directly to hardware devices.</td></tr>
<tr><td><strong>CAP_SYS_RESOURCE</strong></td><td>Allows processes to override resource limits.</td></tr>
<tr><td><strong>CAP_SYS_TIME</strong></td><td>Allows processes to set system time and timers.</td></tr>
<tr><td><strong>CAP_SYS_TTY_CONFIG</strong></td><td>Allows processes to configure tty devices.</td></tr>
<tr><td><strong>CAP_WAKE_ALARM</strong></td><td>Allows processes to use the RTC wakeup alarm.</td></tr>
</tbody></table>
</div>
<h2 id="back-to-top--6"><a class="header" href="#back-to-top--6"><a href="./systemd-service-config.html#systemd-service-hardening">Back to Top ⏫</a></a></h2>
<h2 id="8-system-calls"><a class="header" href="#8-system-calls">8. System Calls</a></h2>
<h3 id="81-systemcallfilter"><a class="header" href="#81-systemcallfilter">8.1. SystemCallFilter</a></h3>
<p><a href="https://www.freedesktop.org/software/systemd/man/systemd.exec.html#SystemCallFilter=">SystemCallFilter</a> specifies a system call filter for the service, restricting the types of system calls that processes within the service can make.</p>
<p><strong>Type</strong>: <em>Space-separated list of system calls.</em><br />
<strong>Default</strong>: If not explicitly specified, there are no restrictions imposed by systemd on system calls.<br />
<strong>Options</strong>:</p>
<ul>
<li><em>List of system calls</em>: Specifies the allowed system calls for processes within the service. If the list begins with "~", the effect is inverted, meaning only the listed system calls will result in termination.</li>
</ul>
<div class="mdbook-alerts mdbook-alerts-tip">
<p class="mdbook-alerts-title">
  <span class="mdbook-alerts-icon"></span>
  tip
</p>
<p>Predefined sets of system calls are available, starting with "@" followed by the name of the set.</p>
</div>
<div class="table-wrapper"><table><thead><tr><th><strong>Filter Set</strong></th><th><strong>Description</strong></th></tr></thead><tbody>
<tr><td><strong>@clock</strong></td><td>Allows clock and timer-related system calls, such as clock_gettime, nanosleep, etc. This is essential for time-related operations.</td></tr>
<tr><td><strong>@cpu-emulation</strong></td><td>Allows CPU emulation-related system calls, typically used by virtualization software.</td></tr>
<tr><td><strong>@debug</strong></td><td>Allows debug-related system calls, which are often used for debugging purposes and may not be necessary for regular operations.</td></tr>
<tr><td><strong>@keyring</strong></td><td>Allows keyring-related system calls, which are used for managing security-related keys and keyrings.</td></tr>
<tr><td><strong>@module</strong></td><td>Allows module-related system calls, which are used for loading and unloading kernel modules. This can be restricted to prevent module loading for security purposes.</td></tr>
<tr><td><strong>@mount</strong></td><td>Allows mount-related system calls, which are essential for mounting and unmounting filesystems.</td></tr>
<tr><td><strong>@network</strong></td><td>Allows network-related system calls, which are crucial for networking operations such as socket creation, packet transmission, etc.</td></tr>
<tr><td><strong>@obsolete</strong></td><td>Allows obsolete system calls, which are no longer in common use and are often deprecated.</td></tr>
<tr><td><strong>@privileged</strong></td><td>Allows privileged system calls, which typically require elevated privileges or are potentially risky if misused.</td></tr>
<tr><td><strong>@raw-io</strong></td><td>Allows raw I/O-related system calls, which provide direct access to hardware devices. This can be restricted to prevent unauthorized access to hardware.</td></tr>
<tr><td><strong>@reboot</strong></td><td>Allows reboot-related system calls, which are necessary for initiating system reboots or shutdowns.</td></tr>
<tr><td><strong>@swap</strong></td><td>Allows swap-related system calls, which are used for managing swap space.</td></tr>
<tr><td><strong>@syslog</strong></td><td>Allows syslog-related system calls, which are used for system logging.</td></tr>
<tr><td><strong>@system-service</strong></td><td>Allows system service-related system calls, which are used for managing system services.</td></tr>
<tr><td><strong>@timer</strong></td><td>Allows timer-related system calls, which are essential for setting and managing timers.</td></tr>
</tbody></table>
</div>
<h2 id="back-to-top--7"><a class="header" href="#back-to-top--7"><a href="./systemd-service-config.html#systemd-service-hardening">Back to Top ⏫</a></a></h2>
</div>
              <div class="sidetoc">
                <nav class="pagetoc"></nav>
              </div>
            </main>

            <nav class="nav-wrapper" aria-label="Page navigation">
              <!-- Mobile navigation buttons -->
              <a
                rel="prev"
                href="../ref_impl/idsvm-development.html"
                class="mobile-nav-chapters previous"
                title="Previous chapter"
                aria-label="Previous chapter"
                aria-keyshortcuts="Left"
              >
                <i class="fa fa-angle-left"></i>
              </a>
               
              <a
                rel="next prefetch"
                href="../troubleshooting/troubleshooting.html"
                class="mobile-nav-chapters next"
                title="Next chapter"
                aria-label="Next chapter"
                aria-keyshortcuts="Right"
              >
                <i class="fa fa-angle-right"></i>
              </a>

              <div style="clear: both"></div>
            </nav>
          </div>
        </div>

        <nav class="nav-wide-wrapper" aria-label="Page navigation">
          <a
            rel="prev"
            href="../ref_impl/idsvm-development.html"
            class="nav-chapters previous"
            title="Previous chapter"
            aria-label="Previous chapter"
            aria-keyshortcuts="Left"
          >
            <i class="fa fa-angle-left"></i>
          </a>
           
          <a
            rel="next prefetch"
            href="../troubleshooting/troubleshooting.html"
            class="nav-chapters next"
            title="Next chapter"
            aria-label="Next chapter"
            aria-keyshortcuts="Right"
          >
            <i class="fa fa-angle-right"></i>
          </a>
        </nav>
      </div>

   
      <script>
        window.playground_copyable = true;
      </script>
        
      <script src="../elasticlunr.min.js"></script>
      <script src="../mark.min.js"></script>
      <script src="../searcher.js"></script>

      <script src="../clipboard.min.js"></script>
      <script src="../highlight.js"></script>
      <script src="../book.js"></script>

      <!-- Custom JS scripts -->
      <script src="../theme/pagetoc.js"></script>
       
    </div>
  </body>
</html>
