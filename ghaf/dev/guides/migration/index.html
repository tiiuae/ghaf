<!DOCTYPE html><html lang="en" dir="ltr" data-theme="dark" data-has-toc data-has-sidebar class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Migration Guide | Ghaf Framework</title><link rel="canonical" href="https://ghaf.tii.ae/ghaf/dev/guides/migration/"/><link rel="sitemap" href="/sitemap-index.xml"/><link rel="shortcut icon" href="/favicon.svg" type="image/svg+xml"/><meta name="generator" content="Astro v5.17.1"/><meta name="generator" content="Starlight v0.37.6"/><meta property="og:title" content="Migration Guide"/><meta property="og:type" content="article"/><meta property="og:url" content="https://ghaf.tii.ae/ghaf/dev/guides/migration/"/><meta property="og:locale" content="en"/><meta property="og:site_name" content="Ghaf Framework"/><meta name="twitter:card" content="summary_large_image"/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg><svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg><svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg></template><link rel="stylesheet" href="/_astro/print.DNXP8c50.css" media="print"><link rel="stylesheet" href="/_astro/index.DRBrafbx.css">
<style>@layer starlight.components{:root{--sl-badge-default-border: var(--sl-color-accent);--sl-badge-default-bg: var(--sl-color-accent-low);--sl-badge-default-text: #fff;--sl-badge-note-border: var(--sl-color-blue);--sl-badge-note-bg: var(--sl-color-blue-low);--sl-badge-note-text: #fff;--sl-badge-danger-border: var(--sl-color-red);--sl-badge-danger-bg: var(--sl-color-red-low);--sl-badge-danger-text: #fff;--sl-badge-success-border: var(--sl-color-green);--sl-badge-success-bg: var(--sl-color-green-low);--sl-badge-success-text: #fff;--sl-badge-caution-border: var(--sl-color-orange);--sl-badge-caution-bg: var(--sl-color-orange-low);--sl-badge-caution-text: #fff;--sl-badge-tip-border: var(--sl-color-purple);--sl-badge-tip-bg: var(--sl-color-purple-low);--sl-badge-tip-text: #fff}[data-theme=light]:root{--sl-badge-default-bg: var(--sl-color-accent-high);--sl-badge-note-bg: var(--sl-color-blue-high);--sl-badge-danger-bg: var(--sl-color-red-high);--sl-badge-success-bg: var(--sl-color-green-high);--sl-badge-caution-bg: var(--sl-color-orange-high);--sl-badge-tip-bg: var(--sl-color-purple-high)}.sl-badge:where(.astro-avdet4wd){display:inline-block;border:1px solid var(--sl-color-border-badge);border-radius:.25rem;font-family:var(--sl-font-system-mono);line-height:normal;color:var(--sl-color-text-badge);background-color:var(--sl-color-bg-badge);overflow-wrap:anywhere}.sidebar-content .sl-badge:where(.astro-avdet4wd){line-height:1;font-size:var(--sl-text-xs);padding:.125rem .375rem}.sidebar-content a[aria-current=page]>.sl-badge:where(.astro-avdet4wd){--sl-color-bg-badge: transparent;--sl-color-border-badge: currentColor;color:inherit}.default:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-default-bg);--sl-color-border-badge: var(--sl-badge-default-border);--sl-color-text-badge: var(--sl-badge-default-text)}.note:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-note-bg);--sl-color-border-badge: var(--sl-badge-note-border);--sl-color-text-badge: var(--sl-badge-note-text)}.danger:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-danger-bg);--sl-color-border-badge: var(--sl-badge-danger-border);--sl-color-text-badge: var(--sl-badge-danger-text)}.success:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-success-bg);--sl-color-border-badge: var(--sl-badge-success-border);--sl-color-text-badge: var(--sl-badge-success-text)}.tip:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-tip-bg);--sl-color-border-badge: var(--sl-badge-tip-border);--sl-color-text-badge: var(--sl-badge-tip-text)}.caution:where(.astro-avdet4wd){--sl-color-bg-badge: var(--sl-badge-caution-bg);--sl-color-border-badge: var(--sl-badge-caution-border);--sl-color-text-badge: var(--sl-badge-caution-text)}.small:where(.astro-avdet4wd){font-size:var(--sl-text-xs);padding:.125rem .25rem}.medium:where(.astro-avdet4wd){font-size:var(--sl-text-sm);padding:.175rem .35rem}.large:where(.astro-avdet4wd){font-size:var(--sl-text-base);padding:.225rem .45rem}.sl-markdown-content :is(h1,h2,h3,h4,h5,h6) .sl-badge:where(.astro-avdet4wd){vertical-align:middle}}
@layer starlight.components{.card:where(.astro-v5tidmuc){--sl-card-border: var(--sl-color-purple);--sl-card-bg: var(--sl-color-purple-low);border:1px solid var(--sl-color-gray-5);background-color:var(--sl-color-black);padding:clamp(1rem,calc(.125rem + 3vw),2.5rem);flex-direction:column;gap:clamp(.5rem,calc(.125rem + 1vw),1rem)}.card:where(.astro-v5tidmuc):nth-child(4n+1){--sl-card-border: var(--sl-color-orange);--sl-card-bg: var(--sl-color-orange-low)}.card:where(.astro-v5tidmuc):nth-child(4n+3){--sl-card-border: var(--sl-color-green);--sl-card-bg: var(--sl-color-green-low)}.card:where(.astro-v5tidmuc):nth-child(4n+4){--sl-card-border: var(--sl-color-red);--sl-card-bg: var(--sl-color-red-low)}.card:where(.astro-v5tidmuc):nth-child(4n+5){--sl-card-border: var(--sl-color-blue);--sl-card-bg: var(--sl-color-blue-low)}.title:where(.astro-v5tidmuc){font-weight:600;font-size:var(--sl-text-h4);color:var(--sl-color-white);line-height:var(--sl-line-height-headings);gap:1rem;align-items:center}.card:where(.astro-v5tidmuc) .icon:where(.astro-v5tidmuc){border:1px solid var(--sl-card-border);background-color:var(--sl-card-bg);padding:.2em;border-radius:.25rem;flex-shrink:0}.card:where(.astro-v5tidmuc) .body:where(.astro-v5tidmuc){margin:0;font-size:clamp(var(--sl-text-sm),calc(.5rem + 1vw),var(--sl-text-body))}}
@layer starlight.components{.card-grid:where(.astro-zntqmydn){display:grid;grid-template-columns:100%;gap:1rem}.card-grid:where(.astro-zntqmydn)>*{margin-top:0!important}@media(min-width:50rem){.card-grid:where(.astro-zntqmydn){grid-template-columns:1fr 1fr;gap:1.5rem}.stagger:where(.astro-zntqmydn){--stagger-height: 5rem;padding-bottom:var(--stagger-height)}.stagger:where(.astro-zntqmydn)>*:nth-child(2n){transform:translateY(var(--stagger-height))}}}
@layer starlight.components{svg:where(.astro-c6vsoqas){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}}
@layer starlight.components{starlight-tabs:where(.astro-esqgolmp){display:block}.tablist-wrapper:where(.astro-esqgolmp){overflow-x:auto}:where(.astro-esqgolmp)[role=tablist]{display:flex;list-style:none;border-bottom:2px solid var(--sl-color-gray-5);padding:0}.tab:where(.astro-esqgolmp){display:flex}.tab:where(.astro-esqgolmp)>:where(.astro-esqgolmp)[role=tab]{--sl-tab-color-border: var(--sl-color-gray-5);display:flex;align-items:center;gap:.5rem;line-height:var(--sl-line-height-headings);padding:.275rem 1.25rem;text-decoration:none;box-shadow:0 2px 0 var(--sl-tab-color-border);color:var(--sl-color-gray-3);outline-offset:var(--sl-outline-offset-inside);overflow-wrap:initial}.tab:where(.astro-esqgolmp) :where(.astro-esqgolmp)[role=tab][aria-selected=true]{--sl-tab-color-border: var(--sl-color-text-accent);color:var(--sl-color-white);font-weight:600}.tablist-wrapper:where(.astro-esqgolmp)~[role=tabpanel]{margin-top:1rem}}
@layer starlight.components{.sl-steps{--bullet-size: calc(var(--sl-line-height) * 1rem);--bullet-margin: .375rem;list-style:none;counter-reset:steps-counter var(--sl-steps-start, 0);padding-inline-start:0}.sl-steps>li{counter-increment:steps-counter;position:relative;padding-inline-start:calc(var(--bullet-size) + 1rem);padding-bottom:1px;min-height:calc(var(--bullet-size) + var(--bullet-margin))}.sl-steps>li+li{margin-top:0}.sl-steps>li:before{content:counter(steps-counter);position:absolute;top:0;inset-inline-start:0;width:var(--bullet-size);height:var(--bullet-size);line-height:var(--bullet-size);font-size:var(--sl-text-xs);font-weight:600;text-align:center;color:var(--sl-color-white);background-color:var(--sl-color-gray-6);border-radius:99rem;box-shadow:inset 0 0 0 1px var(--sl-color-gray-5)}.sl-steps>li:after{--guide-width: 1px;content:"";position:absolute;top:calc(var(--bullet-size) + var(--bullet-margin));bottom:var(--bullet-margin);inset-inline-start:calc((var(--bullet-size) - var(--guide-width)) / 2);width:var(--guide-width);background-color:var(--sl-color-hairline-light)}}@layer starlight.content{.sl-steps>li>:first-child{--lh: calc(1em * var(--sl-line-height));--shift-y: calc(.5 * (var(--bullet-size) - var(--lh)));transform:translateY(var(--shift-y));margin-bottom:var(--shift-y)}.sl-steps>li>:first-child:where(h1,h2,h3,h4,h5,h6){--lh: calc(1em * var(--sl-line-height-headings))}@supports (--prop: 1lh){.sl-steps>li>:first-child{--lh: 1lh}}}
@layer starlight.components{starlight-file-tree:where(.astro-p67cqifm){--x-space: 1.5rem;--y-space: .125rem;--y-pad: 0;display:block;border:1px solid var(--sl-color-gray-5);padding:1rem;background-color:var(--sl-color-gray-6);font-size:var(--sl-text-xs);font-family:var(--__sl-font-mono);overflow-x:auto}starlight-file-tree:where(.astro-p67cqifm) .directory>details{border:0;padding:0;padding-inline-start:var(--x-space);background:transparent}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary{margin-inline-start:calc(-1 * var(--x-space));border:0;padding:var(--y-pad) .625rem;font-weight:400;color:var(--sl-color-white);max-width:100%}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary::marker,starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary::-webkit-details-marker{color:var(--sl-color-gray-3)}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary:hover,starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary:hover .tree-icon{cursor:pointer;color:var(--sl-color-text-accent);fill:currentColor}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary:hover~ul{border-color:var(--sl-color-gray-4)}starlight-file-tree:where(.astro-p67cqifm) .directory>details>summary:hover .highlight .tree-icon{color:var(--sl-color-text-invert);fill:currentColor}starlight-file-tree:where(.astro-p67cqifm) ul{margin-inline-start:.5rem;border-inline-start:1px solid var(--sl-color-gray-5);padding:0;padding-inline-start:.125rem;list-style:none}starlight-file-tree:where(.astro-p67cqifm)>ul{margin:0;border:0;padding:0}starlight-file-tree:where(.astro-p67cqifm) li{margin:var(--y-space) 0;padding:var(--y-pad) 0}starlight-file-tree:where(.astro-p67cqifm) .file{margin-inline-start:calc(var(--x-space) - .125rem);color:var(--sl-color-white)}starlight-file-tree:where(.astro-p67cqifm) .tree-entry{display:inline-flex;align-items:flex-start;flex-wrap:wrap;max-width:calc(100% - 1rem)}@media(min-width:30em){starlight-file-tree:where(.astro-p67cqifm) .tree-entry{flex-wrap:nowrap}}starlight-file-tree:where(.astro-p67cqifm) .tree-entry>:first-child{flex-shrink:0}starlight-file-tree:where(.astro-p67cqifm) .empty{color:var(--sl-color-gray-3);padding-inline-start:.375rem}starlight-file-tree:where(.astro-p67cqifm) .comment{color:var(--sl-color-gray-3);padding-inline-start:1.625rem;max-width:24rem;min-width:12rem}starlight-file-tree:where(.astro-p67cqifm) .highlight{display:inline-block;border-radius:.25rem;padding-inline-end:.5rem;color:var(--sl-color-text-invert);background-color:var(--sl-color-text-accent)}starlight-file-tree:where(.astro-p67cqifm) svg{display:inline;fill:var(--sl-color-gray-3);vertical-align:middle;margin-inline:.25rem .375rem;width:.875rem;height:.875rem}starlight-file-tree:where(.astro-p67cqifm) .highlight svg.tree-icon{fill:currentColor}}
@layer starlight.components{.sl-link-button:where(.astro-xwgiixxa){align-items:center;border:1px solid transparent;border-radius:999rem;display:inline-flex;font-size:var(--sl-text-sm);gap:.5em;line-height:1.1875;outline-offset:.25rem;padding:.4375rem 1.125rem;text-decoration:none}.sl-link-button:where(.astro-xwgiixxa).primary{background:var(--sl-color-text-accent);border-color:var(--sl-color-text-accent);color:var(--sl-color-black)}.sl-link-button:where(.astro-xwgiixxa).primary:hover{color:var(--sl-color-black)}.sl-link-button:where(.astro-xwgiixxa).secondary{border-color:inherit;color:var(--sl-color-white)}.sl-link-button:where(.astro-xwgiixxa).minimal{color:var(--sl-color-white);padding-inline:0}.sl-link-button:where(.astro-xwgiixxa) svg{flex-shrink:0}@media(min-width:50rem){.sl-link-button:where(.astro-xwgiixxa){font-size:var(--sl-text-base);padding:.9375rem 1.25rem}}.sl-markdown-content .sl-link-button:where(.astro-xwgiixxa){margin-inline-end:1rem}.sl-markdown-content .sl-link-button:where(.astro-xwgiixxa):not(:where(p *)){margin-block:1rem}}
</style><script type="module" src="/_astro/page.B1D-nYk3.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header astro-kmkmnagf"> <div class="title-wrapper sl-flex astro-kmkmnagf"> <a href="/" class="site-title sl-flex astro-m46x6ez3">  <span class="astro-m46x6ez3" translate="no"> Ghaf Framework </span> </a>  </div> <div class="sl-flex print:hidden astro-kmkmnagf"> <site-search class="astro-kmkmnagf astro-v37mnknz" data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}"> <button data-open-modal disabled aria-label="Search" aria-keyshortcuts="Control+K" class="astro-v37mnknz"> <svg aria-hidden="true" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg> <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <kbd class="sl-hidden md:sl-flex astro-v37mnknz" style="display: none;"> <kbd class="astro-v37mnknz">Ctrl</kbd><kbd class="astro-v37mnknz">K</kbd> </kbd> </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>  <script>
	(() => {
		const openBtn = document.querySelector('button[data-open-modal]');
		const shortcut = openBtn?.querySelector('kbd');
		if (!openBtn || !(shortcut instanceof HTMLElement)) return;
		const platformKey = shortcut.querySelector('kbd');
		if (platformKey && /(Mac|iPhone|iPod|iPad)/i.test(navigator.platform)) {
			platformKey.textContent = '⌘';
			openBtn.setAttribute('aria-keyshortcuts', 'Meta+K');
		}
		shortcut.style.display = '';
	})();
</script> <script type="module" src="/_astro/Search.astro_astro_type_script_index_0_lang.cjYDvRdi.js"></script>   </div> <div class="sl-hidden md:sl-flex print:hidden right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://github.com/tiiuae/ghaf" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select autocomplete="off" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script> <script type="module">const r="starlight-theme",o=e=>e==="auto"||e==="dark"||e==="light"?e:"auto",c=()=>o(typeof localStorage<"u"&&localStorage.getItem(r));function n(e){typeof localStorage<"u"&&localStorage.setItem(r,e==="light"||e==="dark"?e:"")}const l=()=>matchMedia("(prefers-color-scheme: light)").matches?"light":"dark";function t(e){StarlightThemeProvider.updatePickers(e),document.documentElement.dataset.theme=e==="auto"?l():e,n(e)}matchMedia("(prefers-color-scheme: light)").addEventListener("change",()=>{c()==="auto"&&t("auto")});class s extends HTMLElement{constructor(){super(),t(c()),this.querySelector("select")?.addEventListener("change",a=>{a.currentTarget instanceof HTMLSelectElement&&t(o(a.currentTarget.value))})}}customElements.define("starlight-theme-select",s);</script> <script type="module">class s extends HTMLElement{constructor(){super();const e=this.querySelector("select");e&&(e.addEventListener("change",t=>{t.currentTarget instanceof HTMLSelectElement&&(window.location.pathname=t.currentTarget.value)}),window.addEventListener("pageshow",t=>{if(!t.persisted)return;const n=e.querySelector("option[selected]")?.index;n!==e.selectedIndex&&(e.selectedIndex=n??0)}))}}customElements.define("starlight-lang-select",s);</script> </div> </div> </header> <nav class="sidebar print:hidden astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="print:hidden astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="open-menu astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg> <svg aria-hidden="true" class="close-menu astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="m13.41 12 6.3-6.29a1.004 1.004 0 1 0-1.42-1.42L12 10.59l-6.29-6.3a1.004 1.004 0 0 0-1.42 1.42l6.3 6.29-6.3 6.29a1 1 0 0 0 0 1.42.998.998 0 0 0 1.42 0l6.29-6.3 6.29 6.3a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.42L13.41 12Z"/></svg> </button> </starlight-menu-button> <script type="module">class s extends HTMLElement{constructor(){super(),this.btn=this.querySelector("button"),this.btn.addEventListener("click",()=>this.toggleExpanded());const t=this.closest("nav");t&&t.addEventListener("keyup",e=>this.closeOnEscape(e))}setExpanded(t){this.setAttribute("aria-expanded",String(t)),document.body.toggleAttribute("data-mobile-menu-expanded",t)}toggleExpanded(){this.setExpanded(this.getAttribute("aria-expanded")!=="true")}closeOnEscape(t){t.code==="Escape"&&(this.setExpanded(!1),this.btn.focus())}}customElements.define("starlight-menu-button",s);</script>   <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="starlight-sidebar-topics astro-2fh6iaza"> <li class="astro-2fh6iaza"> <a href="/ghaf/overview/" class="starlight-sidebar-topics-current astro-2fh6iaza"> <div class="starlight-sidebar-topics-icon astro-2fh6iaza"> <svg aria-hidden="true" class="astro-2fh6iaza astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.17 2.06A13.1 13.1 0 0 0 19 1.87a12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2 13.1 13.1 0 0 0-2.17.19 1 1 0 0 0-.83 1v12a1 1 0 0 0 1.17 1 10.9 10.9 0 0 1 8.25 1.91l.12.07h.11a.91.91 0 0 0 .7 0h.11l.12-.07A10.899 10.899 0 0 1 20.83 16 1 1 0 0 0 22 15V3a1 1 0 0 0-.83-.94ZM11 15.35a12.87 12.87 0 0 0-6-1.48H4v-10c.333-.02.667-.02 1 0a10.86 10.86 0 0 1 6 1.8v9.68Zm9-1.44h-1a12.87 12.87 0 0 0-6 1.48V5.67a10.86 10.86 0 0 1 6-1.8c.333-.02.667-.02 1 0v10.04Zm1.17 4.15a13.098 13.098 0 0 0-2.17-.19 12.94 12.94 0 0 0-7 2.05 12.94 12.94 0 0 0-7-2.05c-.727.003-1.453.066-2.17.19A1 1 0 0 0 2 19.21a1 1 0 0 0 1.17.79 10.9 10.9 0 0 1 8.25 1.91 1 1 0 0 0 1.16 0A10.9 10.9 0 0 1 20.83 20a1 1 0 0 0 1.17-.79 1 1 0 0 0-.83-1.15Z"/></svg> </div> <div class="astro-2fh6iaza"> Ghaf Developer Reference  </div> </a> </li><li class="astro-2fh6iaza"> <a href="/givc/overview/" class="astro-2fh6iaza"> <div class="starlight-sidebar-topics-icon astro-2fh6iaza"> <svg aria-hidden="true" class="astro-2fh6iaza astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M15.948 15.948L15.948 18.888L7.926 18.888Q7.800 18.384 7.506 17.922L7.506 17.922L17.922 7.506Q18.804 8.052 19.896 8.052L19.896 8.052Q21.408 8.052 22.542 7.023Q23.676 5.994 23.802 4.461Q23.928 2.928 22.983 1.710Q22.038 0.492 20.526 0.240Q19.014-0.012 17.733 0.828Q16.452 1.668 16.074 3.138L16.074 3.138L7.926 3.138Q7.548 1.710 6.330 0.870Q5.112 0.030 3.621 0.219Q2.130 0.408 1.164 1.521Q0.198 2.634 0.198 4.125Q0.198 5.616 1.164 6.729Q2.130 7.842 3.621 8.031Q5.112 8.220 6.330 7.380Q7.548 6.540 7.926 5.112L7.926 5.112L16.074 5.112Q16.200 5.616 16.494 6.078L16.494 6.078L6.078 16.494Q5.196 15.948 4.146 15.948L4.146 15.948Q2.592 15.948 1.458 16.977Q0.324 18.006 0.198 19.539Q0.072 21.072 1.017 22.290Q1.962 23.508 3.474 23.760Q4.986 24.012 6.267 23.172Q7.548 22.332 7.926 20.862L7.926 20.862L15.948 20.862L15.948 23.802L23.802 23.802L23.802 15.948L15.948 15.948ZM4.146 6.078L4.146 6.078Q3.432 6.078 2.886 5.637Q2.340 5.196 2.214 4.503Q2.088 3.810 2.403 3.201Q2.718 2.592 3.369 2.319Q4.020 2.046 4.692 2.256Q5.364 2.466 5.763 3.033Q6.162 3.600 6.099 4.314Q6.036 5.028 5.532 5.532L5.532 5.532Q4.944 6.078 4.146 6.078ZM19.854 2.172L19.854 2.172Q20.484 2.172 20.967 2.487Q21.450 2.802 21.681 3.369Q21.912 3.936 21.807 4.524Q21.702 5.112 21.282 5.532Q20.862 5.952 20.274 6.057Q19.686 6.162 19.119 5.931Q18.552 5.700 18.237 5.217Q17.922 4.734 17.922 4.104L17.922 4.104Q17.922 3.306 18.489 2.739Q19.056 2.172 19.854 2.172ZM4.146 21.828L4.146 21.828Q3.306 21.828 2.739 21.261Q2.172 20.694 2.172 19.875Q2.172 19.056 2.739 18.489Q3.306 17.922 4.125 17.922Q4.944 17.922 5.532 18.489Q6.120 19.056 6.120 19.875Q6.120 20.694 5.532 21.261Q4.944 21.828 4.146 21.828ZM17.922 21.828L17.922 17.922L21.828 17.922L21.828 21.828L17.922 21.828Z"/></svg> </div> <div class="astro-2fh6iaza"> Ghaf Inter-VM Communication  </div> </a> </li> </ul>  <sl-sidebar-state-persist data-hash="1rjpi1f" class="astro-kku4brbg"> <script aria-hidden="true">
		(() => {
			try {
				if (!matchMedia('(min-width: 50em)').matches) return;
				/** @type {HTMLElement | null} */
				const target = document.querySelector('sl-sidebar-state-persist');
				const state = JSON.parse(sessionStorage.getItem('sl-sidebar-state') || '0');
				if (!target || !state || target.dataset.hash !== state.hash) return;
				window._starlightScrollRestore = state.scroll;
				customElements.define(
					'sl-sidebar-restore',
					class SidebarRestore extends HTMLElement {
						connectedCallback() {
							try {
								const idx = parseInt(this.dataset.index || '');
								const details = this.closest('details');
								if (details && typeof state.open[idx] === 'boolean') details.open = state.open[idx];
							} catch {}
						}
					}
				);
			} catch {}
		})();
	</script>  <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Overview</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="0"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/overview/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">About Ghaf</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/features/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Features</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Architecture</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="1"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Architecture</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/system-architecture/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf Architecture Overview</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/inter-vm-communication-control/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Controlled, Auditable Inter-VM Communication</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/variants/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Architectural Variants</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/hardening/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Hardening</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/vm-memory-wipe/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">VM Memory Zeroing and Wipe on Shutdown</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/prohibited-hardcoded-secrets/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Prohibited Hardcoded Credentials and Cryptographic Secrets</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/critical-services-privilege-escalation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Protecting Critical System Services from Privilege Escalation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/system-logs-encryption/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">System Logs</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/vm-network-separation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">VM Network Separation — Normal vs. Debug Adapters</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/least-privilege/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Principle of Least Privilege — Enforced Across All Users</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/separation-of-duties/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Separation of Duties — Critical Roles and System Operations</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/trusted-vm-whitelisted-repos/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Trusted VM Application Updates — Whitelisted Repositories</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/secureboot/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Secure Boot</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/stack/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Stack</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/guest-tpm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Virtualized TPM for guests</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Architecture Decision Records</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="2"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/adr/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">ADRs</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/adr/minimal-host/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Minimal Host</span> <span class="sl-badge caution small  astro-3ii7xxms astro-avdet4wd">Proposed</span> </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/adr/netvm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Networking Virtual Machine</span> <span class="sl-badge caution small  astro-3ii7xxms astro-avdet4wd">Proposed</span> </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/adr/idsvm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Intrusion Detection System Virtual Machine</span> <span class="sl-badge caution small  astro-3ii7xxms astro-avdet4wd">Proposed</span> </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/adr/platform-bus-passthrough-support/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">rust-vmm—Bus Passthrough Support for Rust VMMs</span> <span class="sl-badge caution small  astro-3ii7xxms astro-avdet4wd">Proposed</span> </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/overview/arch/adr/fss/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Forward Secure Sealing for Audit Logs</span> <span class="sl-badge success small  astro-3ii7xxms astro-avdet4wd">Accepted</span> </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Developer Guide</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="3"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Reference</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="4"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Reference Implementations</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/ubuntu-development-setup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ubuntu Development Setup</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/development/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Development</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/build_and_run/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Build and Run</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/remote_build_setup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Running Remote Build on NixOS</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/installer/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Installer</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/cross_compilation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Cross Compilation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/deferred-disk-encryption/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Deferred Disk Encryption</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/creating_appvm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Creating an Application VM</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/hw-config/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Hardware Configuration</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/profiles-config/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Profiles Configuration</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/packages/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf Packages Reference</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/modules/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf Modules Reference</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/dependencies/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">External Dependencies</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/builder-functions/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Builder Functions</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/cosmic/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">COSMIC Desktop Environment</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/idsvm-development/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">IDS VM Further Development</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/systemd-service-config/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">systemd Service Hardening</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/dynamic-hostname/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Dynamic Hostname Generation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/fleet/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Fleet MDM</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/memory-wipe/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Memory Wipe on Boot and Free</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/kill_switch/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf Kill Switch</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/wireguard-gui/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Wireguard GUI</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/yubikey/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">YubiKey Support</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/ref/ghaf-vms/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf VMs Status Tool</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Troubleshooting</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="5"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/troubleshooting/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Troubleshooting</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/troubleshooting/systemd/system-log/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Analyzing System Log</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/troubleshooting/systemd/systemctl/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Debugging systemd Using systemctl</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/troubleshooting/systemd/systemd-analyzer/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Inspecting Services with systemd-analyze</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/troubleshooting/systemd/strace/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Using strace for Debugging Initialization Sequence</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/troubleshooting/systemd/early-shell/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Early Shell</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ghaf as a Library</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="6"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/library/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf Templates</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/global-config/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Global Configuration System</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/library/example_project/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Example Project</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/library/modules_options/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Modules Options</span>  </a> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Library API</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="7"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/library/vm-helpers/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">VM Helper Functions</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/library/features-api/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Features API</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/library/profiles-api/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Profiles API</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Architecture</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="8"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/architecture/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf Architecture for Developers</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/architecture/vm-composition/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">VM Composition with extendModules</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/architecture/config-propagation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Configuration Propagation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/architecture/module-conventions/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Module Authoring Conventions</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/architecture/anti-patterns/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Anti-Patterns to Avoid</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Developer Guides</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="9"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/guides/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Developer Guides</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/guides/writing-modules/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Writing Modules</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/guides/creating-vms/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Creating VMs</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/guides/adding-features/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Adding Features</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/guides/extending-targets/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Extending Targets</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/guides/downstream-setup/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Downstream Project Setup</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/guides/migration/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Migration Guide</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Technologies</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="10"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Technologies</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/compartment/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Compartmentalization</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Passthrough</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="11"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/passthrough/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Devices Passthrough</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/vfio/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Binding Devices to VFIO Driver to Allow Passthrough</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/device_tree_overlays_pt/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Device Tree Overlays for Passthrough</span>  </a> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">NVIDIA Jetson AGX Orin</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="12"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/nvidia_agx_pt_uart/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">UART Passthrough</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/nvidia_agx_pt_pcie/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">PCIe Passthrough</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/nvidia_uarti_net_vm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">UARTI Passthrough to netvm</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">x86</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="13"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/x86_pcie_crosvm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">x86 PCIe Passthrough with crosvm</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/x86_gpu_passthrough_qemu/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">GPU Passthrough with Qemu</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/nvidia_virtualization_bpmp/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">NVIDIA Jetson AGX Orin: Boot and Power Management Processor Virtualization</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/hypervisor_options/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf-Specific microvm Hypervisor Options</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/hardware_acceleration/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Hardware acceleration in Linux</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/dev/technologies/fake-battery/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Fake battery loading and testing</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Build System and Supply Chain</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="14"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/scs/ci-cd-system/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Continuous Integration and Distribution</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Supply Chain Security</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="15"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/scs/scs/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Introduction</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/scs/slsa-framework/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">SLSA Framework</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/scs/sbom/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Software Bill of Materials (SBOM)</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/scs/pki/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Public Key Infrastructure</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/scs/fss/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Forward Secure Sealing</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/scs/ghaf-security-fix-automation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Security Fix Automation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/scs/patching-automation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Patch Management Automation</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ghaf Showcases and Scenarios</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="16"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/scenarios/showcases/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Showcases</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/scenarios/run_win_vm/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Running Windows 11 in VM on Ghaf</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/scenarios/run_cuttlefish/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Running Android Cuttlefish Virtual Device on Ghaf</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Release Notes</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="17"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/releases/release_notes/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Ghaf Release Notes</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-26011/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-26.01.1</span> <span class="sl-badge success small  astro-3ii7xxms astro-avdet4wd">Latest</span> </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-25121/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.12.1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-25111/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.11.1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-25101/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.10.1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-25093/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.09.3</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-25092/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.09.2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-25091/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.09.1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2508/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.08</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2506/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.06</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2505/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.05</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2504/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.04</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2503/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-25.03</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-24124/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.12.4</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-24123/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.12.3</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-24122/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.12.2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-24121/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.12.1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2412/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.12</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-24094/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.09.4</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-24093/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.09.3</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-24092/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.09.2</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-24091/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.09.1</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2409/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.09</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2406/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.06</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2403/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-24.03</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2312/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-23.12</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2309/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-23.09</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2306/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-23.06</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/releases/ghaf-2305/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Release ghaf-23.05</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Appendices</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="18"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/appendices/glossary/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Glossary</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/appendices/contributing_general/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Contribution Guidelines</span>  </a> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <span class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Research</span>  </span> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </summary> <sl-sidebar-restore data-index="19"></sl-sidebar-restore> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ghaf/appendices/research/installation/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Approaches to Ghaf System Installation</span>  </a> </li><li class="astro-3ii7xxms"> <a href="/ghaf/appendices/research/imx8qm-passthrough/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">i.MX 8QM Ethernet Passthrough</span>  </a> </li> </ul>  </details> </li> </ul>  </details> </li> </ul>   <script aria-hidden="true">
		(() => {
			const scroller = document.getElementById('starlight__sidebar');
			if (!window._starlightScrollRestore || !scroller) return;
			scroller.scrollTop = window._starlightScrollRestore;
			delete window._starlightScrollRestore;
		})();
	</script> </sl-sidebar-state-persist>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="social-icons astro-wu23bvmt"> <a href="https://github.com/tiiuae/ghaf" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg></a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> <select autocomplete="off" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg> </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <script type="module">const a=document.getElementById("starlight__sidebar"),n=a?.querySelector("sl-sidebar-state-persist"),o="sl-sidebar-state",i=()=>{let t=[];const e=n?.dataset.hash||"";try{const s=sessionStorage.getItem(o),r=JSON.parse(s||"{}");Array.isArray(r.open)&&r.hash===e&&(t=r.open)}catch{}return{hash:e,open:t,scroll:a?.scrollTop||0}},c=t=>{try{sessionStorage.setItem(o,JSON.stringify(t))}catch{}},d=()=>c(i()),l=(t,e)=>{const s=i();s.open[e]=t,c(s)};n?.addEventListener("click",t=>{if(!(t.target instanceof Element))return;const e=t.target.closest("summary")?.closest("details");if(!e)return;const s=e.querySelector("sl-sidebar-restore"),r=parseInt(s?.dataset.index||"");isNaN(r)||l(!e.open,r)});addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&d()});addEventListener("pageHide",d);</script> <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container print:hidden astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <script type="module" src="/_astro/MobileTableOfContents.astro_astro_type_script_index_0_lang.hwBsy0Mo.js"></script><script type="module" src="/_astro/TableOfContents.astro_astro_type_script_index_0_lang.FuRcXuRY.js"></script><div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><span class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg></span><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#overview-of-changes" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview of Changes</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#migration-path" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Migration Path</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-1-update-module-arguments" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 1: Update Module Arguments</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-2-update-vm-base-modules" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 2: Update VM Base Modules</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-3-update-extramodules-usage" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 3: Update extraModules Usage</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-4-update-feature-configuration" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 4: Update Feature Configuration</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-5-update-profile-selection" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 5: Update Profile Selection</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#common-migration-patterns" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Common Migration Patterns</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#pattern-threading-inputs" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Pattern: Threading Inputs</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#pattern-accessing-host-config-in-vm" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Pattern: Accessing Host Config in VM</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#pattern-conditional-vm-features" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Pattern: Conditional VM Features</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#downstream-project-migration" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Downstream Project Migration</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#before-legacy-downstream" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Before (Legacy Downstream)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#after-modern-downstream" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">After (Modern Downstream)</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#module-migration-checklist" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Module Migration Checklist</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#breaking-changes-reference" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Breaking Changes Reference</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#removed-options" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Removed Options</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#changed-behavior" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Changed Behavior</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#getting-help" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Getting Help</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#see-also" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">See Also</span> </a>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#overview-of-changes" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview of Changes</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#migration-path" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Migration Path</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-1-update-module-arguments" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 1: Update Module Arguments</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-2-update-vm-base-modules" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 2: Update VM Base Modules</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-3-update-extramodules-usage" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 3: Update extraModules Usage</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-4-update-feature-configuration" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 4: Update Feature Configuration</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#step-5-update-profile-selection" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Step 5: Update Profile Selection</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#common-migration-patterns" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Common Migration Patterns</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#pattern-threading-inputs" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Pattern: Threading Inputs</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#pattern-accessing-host-config-in-vm" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Pattern: Accessing Host Config in VM</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#pattern-conditional-vm-features" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Pattern: Conditional VM Features</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#downstream-project-migration" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Downstream Project Migration</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#before-legacy-downstream" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Before (Legacy Downstream)</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#after-modern-downstream" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">After (Modern Downstream)</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#module-migration-checklist" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Module Migration Checklist</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#breaking-changes-reference" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Breaking Changes Reference</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#removed-options" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Removed Options</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#changed-behavior" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Changed Behavior</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#getting-help" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Getting Help</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#see-also" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">See Also</span> </a>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body class="astro-bguv2lll" lang="en" dir="ltr">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">Migration Guide</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> 
<div class="sl-heading-wrapper level-h1"><h1 id="migration-guide">Migration Guide</h1><a class="sl-anchor-link" href="#migration-guide"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Migration Guide”</span></a></div>
<p>This guide helps migrate code from legacy Ghaf patterns to the modern composition-based architecture.</p>
<div class="sl-heading-wrapper level-h2"><h2 id="overview-of-changes">Overview of Changes</h2><a class="sl-anchor-link" href="#overview-of-changes"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Overview of Changes”</span></a></div>
<p>The Ghaf architecture has been significantly refactored to improve composability and maintainability:</p>



































<table><thead><tr><th>Aspect</th><th>Legacy Pattern</th><th>Modern Pattern</th></tr></thead><tbody><tr><td>Host-VM communication</td><td><code dir="auto">configHost = config;</code></td><td><code dir="auto">globalConfig</code> + <code dir="auto">hostConfig</code> via specialArgs</td></tr><tr><td>VM customization</td><td><code dir="auto">extraModules</code> option</td><td><code dir="auto">extendModules</code> on VM bases</td></tr><tr><td>Settings propagation</td><td>Manual threading</td><td><code dir="auto">specialArgs</code> injection</td></tr><tr><td>Feature assignment</td><td>Hardcoded in VMs</td><td><code dir="auto">globalConfig.features</code> with targetVms</td></tr><tr><td>Profile selection</td><td>Debug flag checks</td><td><code dir="auto">lib.ghaf.profiles.*</code></td></tr></tbody></table>
<div class="sl-heading-wrapper level-h2"><h2 id="migration-path">Migration Path</h2><a class="sl-anchor-link" href="#migration-path"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Migration Path”</span></a></div>
<div class="sl-heading-wrapper level-h3"><h3 id="step-1-update-module-arguments">Step 1: Update Module Arguments</h3><a class="sl-anchor-link" href="#step-1-update-module-arguments"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Step 1: Update Module Arguments”</span></a></div>
<p><strong>Legacy:</strong></p>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.v4551.css"><script type="module" src="/_astro/ec.0vx5m.js"></script><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">configHost</span><span style="--0:#D6DEEB;--1:#403F53"> }:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">let</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">cfg</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">configHost</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">virtualization</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">microvm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">guivm</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">in</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">profiles</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">debug</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">configHost</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">profiles</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">debug</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="{ configHost }:let  cfg = configHost.ghaf.virtualization.microvm.guivm;in{  config = {    ghaf.profiles.debug.enable = configHost.ghaf.profiles.debug.enable;  };}"><div></div></button></div></figure></div>
<p><strong>Modern:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">config,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">lib,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">globalConfig,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">hostConfig,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">_file</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">./my-module.nix</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">profiles</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">debug</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">globalConfig</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">debug</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">networking</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">hostName</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">hostConfig</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">vmName</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="{ config, lib, globalConfig, hostConfig, ... }:{  _file = ./my-module.nix;  config = {    ghaf.profiles.debug.enable = globalConfig.debug.enable;    networking.hostName = hostConfig.vmName;  };}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="step-2-update-vm-base-modules">Step 2: Update VM Base Modules</h3><a class="sl-anchor-link" href="#step-2-update-vm-base-modules"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Step 2: Update VM Base Modules”</span></a></div>
<p><strong>Legacy:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># Inline in guivm.nix</span></div></div><div class="ec-line"><div class="code"><span style="--1:#403F53"><span style="--0:#D7DBE0">guivmBaseConfiguration</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">imports</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">...</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">profiles</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">debug</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">configHost</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">profiles</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">debug</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">networking</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">hostName</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">gui-vm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#919F9F;--1:#5F636F"># ... hundreds of lines of config</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">microvm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">vms</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">gui-vm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">config</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">guivmBaseConfiguration</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#7FDBCA;--1:#096E72">//</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">imports</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">guivmBaseConfiguration</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">imports</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#7FDBCA;--1:#096E72">++</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">cfg</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">extraModules</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# Inline in guivm.nixguivmBaseConfiguration = {  imports = [ ... ];  config = {    ghaf.profiles.debug.enable = configHost.ghaf.profiles.debug.enable;    networking.hostName = &#x22;gui-vm&#x22;;    # ... hundreds of lines of config  };};microvm.vms.gui-vm.config = guivmBaseConfiguration // {  imports = guivmBaseConfiguration.imports ++ cfg.extraModules;};"><div></div></button></div></figure></div>
<p><strong>Modern:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In guivm-base.nix (separate file)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">globalConfig,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">hostConfig,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">_file</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">./guivm-base.nix</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">profiles</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">debug</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">globalConfig</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">debug</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">networking</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">hostName</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">hostConfig</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">vmName</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#919F9F;--1:#5F636F"># ... config with specialArgs access</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In profile (laptop-x86.nix)</span></div></div><div class="ec-line"><div class="code"><span style="--1:#403F53"><span style="--0:#D7DBE0">guivmBase</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">lib</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">nixosSystem</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">specialArgs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">lib</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">vm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">mkSpecialArgs</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">inherit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3B61B0">lib</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3B61B0">inputs</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">globalConfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">config</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">global-config</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">hostConfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">lib</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">vm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">mkHostConfig</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C792EA;--1:#8844AE">inherit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3B61B0">config</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C5E478;--1:#3B61B0">vmName</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">gui-vm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">modules</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">guivm-base</span><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">hardwareExtras</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In guivm.nix - wire up using evaluatedConfig</span></div></div><div class="ec-line"><div class="code"><span style="--1:#403F53"><span style="--0:#D7DBE0">config</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">lib</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">mkIf</span><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">cfg</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">microvm</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">vms</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">gui-vm</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">evaluatedConfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">cfg</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">evaluatedConfig</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In guivm-base.nix (separate file){ globalConfig, hostConfig, ... }:{  _file = ./guivm-base.nix;  ghaf.profiles.debug.enable = globalConfig.debug.enable;  networking.hostName = hostConfig.vmName;  # ... config with specialArgs access}# In profile (laptop-x86.nix)guivmBase = lib.nixosSystem {  specialArgs = lib.ghaf.vm.mkSpecialArgs {    inherit lib inputs;    globalConfig = config.ghaf.global-config;    hostConfig = lib.ghaf.vm.mkHostConfig {      inherit config;      vmName = &#x22;gui-vm&#x22;;    };  };  modules = [ guivm-base hardwareExtras ];};# In guivm.nix - wire up using evaluatedConfigconfig = lib.mkIf cfg.enable {  microvm.vms.gui-vm.evaluatedConfig = cfg.evaluatedConfig;};"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="step-3-update-extramodules-usage">Step 3: Update extraModules Usage</h3><a class="sl-anchor-link" href="#step-3-update-extramodules-usage"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Step 3: Update extraModules Usage”</span></a></div>
<p><strong>Legacy:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In modules.nix</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">virtualization</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">microvm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">guivm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">extraModules</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--1:#403F53">  </span></span><span style="--0:#D7DBE0;--1:#403F53">firmwareModule</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--1:#403F53">  </span></span><span style="--0:#D7DBE0;--1:#403F53">servicesModule</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--1:#403F53">  </span></span><span style="--0:#D7DBE0;--1:#403F53">desktopModule</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In target</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">virtualization</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">microvm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">guivm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">extraModules</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">lib</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">mkAfter</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#D9F5DD;--1:#111111">[</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--1:#403F53">  </span></span><span style="--0:#D7DBE0;--1:#403F53">myCustomModule</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In modules.nixghaf.virtualization.microvm.guivm.extraModules = [  firmwareModule  servicesModule  desktopModule];# In targetghaf.virtualization.microvm.guivm.extraModules = lib.mkAfter [  myCustomModule];"><div></div></button></div></figure></div>
<p><strong>Modern:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In profile - compose base with hardware modules</span></div></div><div class="ec-line"><div class="code"><span style="--1:#403F53"><span style="--0:#D7DBE0">guivmBase</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">lib</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">nixosSystem</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">specialArgs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">...</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">modules</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--1:#403F53">    </span></span><span style="--0:#D7DBE0;--1:#403F53">guivm-base</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--1:#403F53">    </span></span><span style="--0:#D7DBE0;--1:#403F53">hardware</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">definition</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">guivm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">extraModules</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#919F9F;--1:#5F636F"># Feature modules auto-included via imports</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In target - use extendModules</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">let</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">baseVm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">config</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">profiles</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">laptop-x86</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">guivmBase</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">extendedVm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">baseVm</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">extendModules</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">modules</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">myCustomModule</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">in</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#919F9F;--1:#5F636F"># Pass the full system result, not .config</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">virtualization</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">microvm</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">guivm</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">evaluatedConfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">extendedVm</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In profile - compose base with hardware modulesguivmBase = lib.nixosSystem {  specialArgs = ...;  modules = [    guivm-base    hardware.definition.guivm.extraModules    # Feature modules auto-included via imports  ];};# In target - use extendModuleslet  baseVm = config.ghaf.profiles.laptop-x86.guivmBase;  extendedVm = baseVm.extendModules {    modules = [ myCustomModule ];  };in{  # Pass the full system result, not .config  ghaf.virtualization.microvm.guivm.evaluatedConfig = extendedVm;}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="step-4-update-feature-configuration">Step 4: Update Feature Configuration</h3><a class="sl-anchor-link" href="#step-4-update-feature-configuration"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Step 4: Update Feature Configuration”</span></a></div>
<p><strong>Legacy:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># Hardcoded in guivm-base.nix</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">services</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprintd</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">true</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># Or with option</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">services</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprintd</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">cfg</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprint</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">enable</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# Hardcoded in guivm-base.nixservices.fprintd.enable = true;# Or with optionservices.fprintd.enable = cfg.features.fprint.enable;"><div></div></button></div></figure></div>
<p><strong>Modern:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In global config</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">global-config</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">fprint</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">true</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">targetVms</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">gui-vm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In VM base</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">services</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprintd</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--1:#403F53">  </span></span><span style="--0:#D7DBE0;--1:#403F53">lib</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">isEnabledFor</span><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">globalConfig</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">fprint</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">gui-vm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In global configghaf.global-config.features.fprint = {  enable = true;  targetVms = [ &#x22;gui-vm&#x22; ];};# In VM baseservices.fprintd.enable =  lib.ghaf.features.isEnabledFor globalConfig &#x22;fprint&#x22; &#x22;gui-vm&#x22;;"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="step-5-update-profile-selection">Step 5: Update Profile Selection</h3><a class="sl-anchor-link" href="#step-5-update-profile-selection"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Step 5: Update Profile Selection”</span></a></div>
<p><strong>Legacy:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In target</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">let</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">variant</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">debug</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#C792EA;--1:#8844AE">in</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#919F9F;--1:#5F636F"># Manual debug/release logic everywhere</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">profiles</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">debug</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">variant</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#7FDBCA;--1:#096E72">==</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">debug</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">development</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">ssh</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">daemon</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">variant</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#7FDBCA;--1:#096E72">==</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">debug</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#919F9F;--1:#5F636F"># ... repeated for every option</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In target{ ... }:let  variant = &#x22;debug&#x22;;in{  # Manual debug/release logic everywhere  ghaf.profiles.debug.enable = variant == &#x22;debug&#x22;;  ghaf.development.ssh.daemon.enable = variant == &#x22;debug&#x22;;  # ... repeated for every option}"><div></div></button></div></figure></div>
<p><strong>Modern:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In target - use variant parameter</span></div></div><div class="ec-line"><div class="code"><span style="--1:#403F53"><span style="--0:#D7DBE0">mkGhafConfiguration</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">name</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">my-target</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">system</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">x86_64-linux</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">profile</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">laptop-x86</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">hardwareModule</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">self</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">nixosModules</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">hardware-my-target</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">variant</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">debug</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;  </span><span style="--0:#919F9F;--1:#5F636F"># Auto-applies lib.ghaf.profiles.debug via mkDefault</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># Or with customization via extraConfig</span></div></div><div class="ec-line"><div class="code"><span style="--1:#403F53"><span style="--0:#D7DBE0">mkGhafConfiguration</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#919F9F;--1:#5F636F"># ... params ...</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">variant</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">debug</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">extraConfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">global-config</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">features</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">bluetooth</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">false</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In target - use variant parametermkGhafConfiguration {  name = &#x22;my-target&#x22;;  system = &#x22;x86_64-linux&#x22;;  profile = &#x22;laptop-x86&#x22;;  hardwareModule = self.nixosModules.hardware-my-target;  variant = &#x22;debug&#x22;;  # Auto-applies lib.ghaf.profiles.debug via mkDefault}# Or with customization via extraConfigmkGhafConfiguration {  # ... params ...  variant = &#x22;debug&#x22;;  extraConfig = {    global-config.features.bluetooth.enable = false;  };};"><div></div></button></div></figure></div>
<hr>
<div class="sl-heading-wrapper level-h2"><h2 id="common-migration-patterns">Common Migration Patterns</h2><a class="sl-anchor-link" href="#common-migration-patterns"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Common Migration Patterns”</span></a></div>
<div class="sl-heading-wrapper level-h3"><h3 id="pattern-threading-inputs">Pattern: Threading Inputs</h3><a class="sl-anchor-link" href="#pattern-threading-inputs"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Pattern: Threading Inputs”</span></a></div>
<p><strong>Legacy (Anti-pattern):</strong></p>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">module-a.nix</span></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">inputs</span><span style="--0:#D6DEEB;--1:#403F53"> }:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">imports</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--0:#D6DEEB;--1:#403F53"> (</span><span style="--0:#C5E478;--1:#3B61B0">import</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">./module-b.nix</span><span style="--0:#D6DEEB;--1:#403F53"> { </span><span style="--0:#C792EA;--1:#8844AE">inherit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3B61B0">inputs</span><span style="--0:#D6DEEB;--1:#403F53">; }) </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># module-b.nix</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">inputs</span><span style="--0:#D6DEEB;--1:#403F53"> }:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">config</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C5E478;--1:#3B61B0">something</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">inputs</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">self</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">packages</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">x86_64-linux</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">foo</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">  </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="{ inputs }:{  imports = [ (import ./module-b.nix { inherit inputs; }) ];}# module-b.nix{ inputs }:{  config = {    something = inputs.self.packages.x86_64-linux.foo;  };}"><div></div></button></div></figure></div>
<p><strong>Modern:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In evaluation (profile or target)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">lib</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">nixosSystem</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">specialArgs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> { </span><span style="--0:#C792EA;--1:#8844AE">inherit</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3B61B0">inputs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#C5E478;--1:#3B61B0">lib</span><span style="--0:#D6DEEB;--1:#403F53">; };</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">modules</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">./module-a.nix</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">./module-b.nix</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In module-b.nix</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">inputs,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}:  </span><span style="--0:#919F9F;--1:#5F636F"># Available from specialArgs</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">config</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">something</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">inputs</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">self</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">packages</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">x86_64-linux</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">foo</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In evaluation (profile or target)lib.nixosSystem {  specialArgs = { inherit inputs lib; };  modules = [ ./module-a.nix ./module-b.nix ];}# In module-b.nix{ inputs, ... }:  # Available from specialArgs{  config.something = inputs.self.packages.x86_64-linux.foo;}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="pattern-accessing-host-config-in-vm">Pattern: Accessing Host Config in VM</h3><a class="sl-anchor-link" href="#pattern-accessing-host-config-in-vm"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Pattern: Accessing Host Config in VM”</span></a></div>
<p><strong>Legacy:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># VM module</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">configHost</span><span style="--0:#D6DEEB;--1:#403F53"> }:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">services</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">foo</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">hostAddress</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">configHost</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">common</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">extraNetworking</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">hostAddress</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">services</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">foo</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">debug</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">configHost</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">profiles</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">debug</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# VM module{ configHost }:{  services.foo.hostAddress = configHost.ghaf.common.extraNetworking.hostAddress;  services.foo.debug = configHost.ghaf.profiles.debug.enable;}"><div></div></button></div></figure></div>
<p><strong>Modern:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># VM module</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{ </span><span style="--0:#7FDBCA;--1:#096E72">globalConfig,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">hostConfig,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}:</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">services</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">foo</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">hostAddress</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">hostConfig</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">networking</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">hostAddress</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">services</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">foo</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">debug</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">globalConfig</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">debug</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# VM module{ globalConfig, hostConfig, ... }:{  services.foo.hostAddress = hostConfig.networking.hostAddress;  services.foo.debug = globalConfig.debug.enable;}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="pattern-conditional-vm-features">Pattern: Conditional VM Features</h3><a class="sl-anchor-link" href="#pattern-conditional-vm-features"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Pattern: Conditional VM Features”</span></a></div>
<p><strong>Legacy:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In modules.nix</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">options</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">virtualization</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">microvm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">guivm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprint</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">...</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In guivm.nix</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">services</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprintd</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">cfg</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprint</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">enable</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In profile</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">virtualization</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">microvm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">guivm</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprint</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">true</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In modules.nixoptions.ghaf.virtualization.microvm.guivm.features.fprint.enable = ...;# In guivm.nixservices.fprintd.enable = cfg.features.fprint.enable;# In profileghaf.virtualization.microvm.guivm.features.fprint.enable = true;"><div></div></button></div></figure></div>
<p><strong>Modern:</strong></p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In lib/global-config.nix</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">fprint</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--0:#D6DEEB;--1:#403F53"> {</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">enable</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">mkEnableOption</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">fingerprint</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">//</span><span style="--0:#D6DEEB;--1:#403F53"> { </span><span style="--0:#C5E478;--1:#3B61B0">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#82AAFF;--1:#3B61B0">true</span><span style="--0:#D6DEEB;--1:#403F53">; };</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">targetVms</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">mkOption</span><span style="--0:#D6DEEB"> { </span></span><span style="--0:#C5E478;--1:#3B61B0">default</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">gui-vm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">; };</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In guivm-base.nix</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">services</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprintd</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">enable</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--1:#403F53">  </span></span><span style="--0:#D7DBE0;--1:#403F53">lib</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">isEnabledFor</span><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">globalConfig</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">fprint</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">gui-vm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div><div class="ec-line"><div class="code">
</div></div><div class="ec-line"><div class="code"><span style="--0:#919F9F;--1:#5F636F"># In target (to customize)</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">global-config</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">features</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">fprint</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">targetVms</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#FFFFFF;--1:#984E4D">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">admin-vm</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#FFFFFF;--1:#984E4D">;</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="# In lib/global-config.nixfeatures.fprint = {  enable = mkEnableOption &#x22;fingerprint&#x22; // { default = true; };  targetVms = mkOption { default = [ &#x22;gui-vm&#x22; ]; };};# In guivm-base.nixservices.fprintd.enable =  lib.ghaf.features.isEnabledFor globalConfig &#x22;fprint&#x22; &#x22;gui-vm&#x22;;# In target (to customize)ghaf.global-config.features.fprint.targetVms = [ &#x22;admin-vm&#x22; ];"><div></div></button></div></figure></div>
<hr>
<div class="sl-heading-wrapper level-h2"><h2 id="downstream-project-migration">Downstream Project Migration</h2><a class="sl-anchor-link" href="#downstream-project-migration"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Downstream Project Migration”</span></a></div>
<div class="sl-heading-wrapper level-h3"><h3 id="before-legacy-downstream">Before (Legacy Downstream)</h3><a class="sl-anchor-link" href="#before-legacy-downstream"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Before (Legacy Downstream)”</span></a></div>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">flake.nix</span></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">outputs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> { </span><span style="--0:#7FDBCA;--1:#096E72">ghaf,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">let</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C5E478;--1:#3B61B0">laptop-configuration</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">ghaf</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">builders</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">laptop-configuration</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">in</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C5E478;--1:#3B61B0">nixosConfigurations</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">my-product</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">laptop-configuration</span><span style="--0:#D6DEEB"> </span></span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">lenovo-x1</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">debug</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#ECC48D;--1:#3B61B0">./hardware.nix</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">({ </span><span style="--0:#7FDBCA;--1:#096E72">config,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}: {</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#919F9F;--1:#5F636F"># Customize via extraModules option</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">virtualization</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">microvm</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">guivm</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">extraModules</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#ECC48D;--1:#3B61B0">./my-gui-customizations.nix</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">        </span></span><span style="--0:#D6DEEB;--1:#403F53">})</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="{  outputs = { ghaf, ... }:    let      laptop-configuration = ghaf.builders.laptop-configuration;    in    {      nixosConfigurations.my-product = laptop-configuration &#x22;lenovo-x1&#x22; &#x22;debug&#x22; [        ./hardware.nix        ({ config, ... }: {          # Customize via extraModules option          ghaf.virtualization.microvm.guivm.extraModules = [            ./my-gui-customizations.nix          ];        })      ];    };}"><div></div></button></div></figure></div>
<div class="sl-heading-wrapper level-h3"><h3 id="after-modern-downstream">After (Modern Downstream)</h3><a class="sl-anchor-link" href="#after-modern-downstream"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “After (Modern Downstream)”</span></a></div>
<div class="expressive-code"><figure class="frame has-title not-content"><figcaption class="header"><span class="title">flake.nix</span></figcaption><pre data-language="nix"><code><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">  </span><span style="--0:#C5E478;--1:#3B61B0">outputs</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> { </span><span style="--0:#7FDBCA;--1:#096E72">ghaf,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}:</span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">let</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C5E478;--1:#3B61B0">mkGhafConfiguration</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">ghaf</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">lib</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">builders</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">mkGhafConfiguration</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">    </span><span style="--0:#C792EA;--1:#8844AE">in</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">      </span><span style="--0:#C5E478;--1:#3B61B0">nixosConfigurations</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">my-product-debug</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">mkGhafConfiguration</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C5E478;--1:#3B61B0">name</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">my-product</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C5E478;--1:#3B61B0">system</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">x86_64-linux</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C5E478;--1:#3B61B0">profile</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">laptop-x86</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C5E478;--1:#3B61B0">hardwareModule</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">ghaf</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">nixosModules</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">hardware-lenovo-x1-carbon-gen11</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C5E478;--1:#3B61B0">variant</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#ECC48D;--1:#984E4D">debug</span><span style="--0:#D9F5DD;--1:#111111">"</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#C5E478;--1:#3B61B0">extraModules</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">({ </span><span style="--0:#7FDBCA;--1:#096E72">config,</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">... </span><span style="--0:#D6DEEB;--1:#403F53">}:</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">let</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C5E478;--1:#3B61B0">baseVm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">config</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">ghaf</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">profiles</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--0:#D7DBE0;--1:#403F53">laptop-x86</span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">guivmBase</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C5E478;--1:#3B61B0">extendedVm</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">baseVm</span></span><span style="--0:#7FDBCA;--1:#096E72">.</span><span style="--1:#403F53"><span style="--0:#D7DBE0">extendModules</span><span style="--0:#D6DEEB"> {</span></span></div></div><div class="ec-line"><div class="code"><span class="indent">              </span><span style="--0:#C5E478;--1:#3B61B0">modules</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">[</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">./my-gui-customizations.nix</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">            </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span class="indent">          </span><span style="--0:#C792EA;--1:#8844AE">in</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">{</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#919F9F;--1:#5F636F"># Pass the full system result, not .config</span></div></div><div class="ec-line"><div class="code"><span class="indent">            </span><span style="--0:#C5E478;--1:#3B61B0">ghaf</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">virtualization</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">microvm</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">guivm</span><span style="--0:#D6DEEB;--1:#403F53">.</span><span style="--0:#C5E478;--1:#3B61B0">evaluatedConfig</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#7FDBCA;--1:#096E72">=</span><span style="--1:#403F53"><span style="--0:#D6DEEB"> </span><span style="--0:#D7DBE0">extendedVm</span><span style="--0:#D6DEEB">;</span></span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">          </span></span><span style="--0:#D6DEEB;--1:#403F53">})</span></div></div><div class="ec-line"><div class="code"><span class="indent">        </span><span style="--0:#D9F5DD;--1:#111111">]</span><span style="--0:#D6DEEB;--1:#403F53">;</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">      </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span class="indent"><span style="--0:#D6DEEB;--1:#403F53">    </span></span><span style="--0:#D6DEEB;--1:#403F53">};</span></div></div><div class="ec-line"><div class="code"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></div></code></pre><div class="copy"><div aria-live="polite"></div><button title="Copy to clipboard" data-copied="Copied!" data-code="{  outputs = { ghaf, ... }:    let      mkGhafConfiguration = ghaf.lib.ghaf.builders.mkGhafConfiguration;    in    {      nixosConfigurations.my-product-debug = mkGhafConfiguration {        name = &#x22;my-product&#x22;;        system = &#x22;x86_64-linux&#x22;;        profile = &#x22;laptop-x86&#x22;;        hardwareModule = ghaf.nixosModules.hardware-lenovo-x1-carbon-gen11;        variant = &#x22;debug&#x22;;        extraModules = [          ({ config, ... }:          let            baseVm = config.ghaf.profiles.laptop-x86.guivmBase;            extendedVm = baseVm.extendModules {              modules = [ ./my-gui-customizations.nix ];            };          in          {            # Pass the full system result, not .config            ghaf.virtualization.microvm.guivm.evaluatedConfig = extendedVm;          })        ];      };    };}"><div></div></button></div></figure></div>
<hr>
<div class="sl-heading-wrapper level-h2"><h2 id="module-migration-checklist">Module Migration Checklist</h2><a class="sl-anchor-link" href="#module-migration-checklist"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Module Migration Checklist”</span></a></div>
<p>For each module you’re migrating:</p>
<ul class="contains-task-list">
<li class="task-list-item"><input type="checkbox" disabled> Add <code dir="auto">_file = ./module-name.nix;</code> as first attribute</li>
<li class="task-list-item"><input type="checkbox" disabled> Replace <code dir="auto">{ configHost }:</code> with <code dir="auto">{ config, lib, globalConfig, hostConfig, ... }:</code></li>
<li class="task-list-item"><input type="checkbox" disabled> Replace <code dir="auto">configHost.ghaf.profiles.debug.enable</code> with <code dir="auto">globalConfig.debug.enable</code></li>
<li class="task-list-item"><input type="checkbox" disabled> Replace hardcoded VM names with <code dir="auto">hostConfig.vmName</code></li>
<li class="task-list-item"><input type="checkbox" disabled> Replace <code dir="auto">configHost.ghaf.common.extraNetworking.*</code> with <code dir="auto">hostConfig.networking.*</code></li>
<li class="task-list-item"><input type="checkbox" disabled> Replace feature checks with <code dir="auto">lib.ghaf.features.isEnabledFor</code></li>
<li class="task-list-item"><input type="checkbox" disabled> Remove <code dir="auto">{ inputs }:</code> wrapper if present (use specialArgs instead)</li>
<li class="task-list-item"><input type="checkbox" disabled> Add proper imports from inputs</li>
<li class="task-list-item"><input type="checkbox" disabled> Use <code dir="auto">lib.mkDefault</code> for overridable values</li>
<li class="task-list-item"><input type="checkbox" disabled> Test build with <code dir="auto">nix build .#target --dry-run</code></li>
</ul>
<hr>
<div class="sl-heading-wrapper level-h2"><h2 id="breaking-changes-reference">Breaking Changes Reference</h2><a class="sl-anchor-link" href="#breaking-changes-reference"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Breaking Changes Reference”</span></a></div>
<div class="sl-heading-wrapper level-h3"><h3 id="removed-options">Removed Options</h3><a class="sl-anchor-link" href="#removed-options"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Removed Options”</span></a></div>





























<table><thead><tr><th>Removed</th><th>Replacement</th></tr></thead><tbody><tr><td><code dir="auto">ghaf.virtualization.microvm.*.extraModules</code></td><td>Use <code dir="auto">extendModules</code> on VM base</td></tr><tr><td><code dir="auto">modules.nix</code> feature options</td><td><code dir="auto">globalConfig.features.*</code></td></tr><tr><td><code dir="auto">lib.ghaf.mkVmSpecialArgs</code></td><td><code dir="auto">lib.ghaf.vm.mkSpecialArgs</code></td></tr><tr><td><code dir="auto">lib.ghaf.mkVmHostConfig</code></td><td><code dir="auto">lib.ghaf.vm.mkHostConfig</code></td></tr><tr><td><code dir="auto">lib.ghaf.getVmConfig</code></td><td><code dir="auto">lib.ghaf.vm.getConfig</code></td></tr></tbody></table>
<div class="sl-heading-wrapper level-h3"><h3 id="changed-behavior">Changed Behavior</h3><a class="sl-anchor-link" href="#changed-behavior"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Changed Behavior”</span></a></div>





















<table><thead><tr><th>Change</th><th>Impact</th></tr></thead><tbody><tr><td>VMs require <code dir="auto">evaluatedConfig</code></td><td>Must set via profile or extendModules</td></tr><tr><td>Features centralized</td><td>Move feature config to <code dir="auto">globalConfig.features</code></td></tr><tr><td>Profiles simplified</td><td>Use <code dir="auto">lib.ghaf.profiles.*</code> for common presets</td></tr></tbody></table>
<hr>
<div class="sl-heading-wrapper level-h2"><h2 id="getting-help">Getting Help</h2><a class="sl-anchor-link" href="#getting-help"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “Getting Help”</span></a></div>
<p>If you encounter issues migrating:</p>
<ol>
<li>Check the <a href="/ghaf/dev/architecture/">Architecture Documentation</a></li>
<li>Review <a href="/ghaf/dev/architecture/anti-patterns">Anti-Patterns</a> for common mistakes</li>
<li>Look at existing modules for examples</li>
<li>Open an issue on GitHub with specific error messages</li>
</ol>
<hr>
<div class="sl-heading-wrapper level-h2"><h2 id="see-also">See Also</h2><a class="sl-anchor-link" href="#see-also"><span aria-hidden="true" class="sl-anchor-icon"><svg width="16" height="16" viewBox="0 0 24 24"><path fill="currentcolor" d="m12.11 15.39-3.88 3.88a2.52 2.52 0 0 1-3.5 0 2.47 2.47 0 0 1 0-3.5l3.88-3.88a1 1 0 0 0-1.42-1.42l-3.88 3.89a4.48 4.48 0 0 0 6.33 6.33l3.89-3.88a1 1 0 1 0-1.42-1.42Zm8.58-12.08a4.49 4.49 0 0 0-6.33 0l-3.89 3.88a1 1 0 0 0 1.42 1.42l3.88-3.88a2.52 2.52 0 0 1 3.5 0 2.47 2.47 0 0 1 0 3.5l-3.88 3.88a1 1 0 1 0 1.42 1.42l3.88-3.89a4.49 4.49 0 0 0 0-6.33ZM8.83 15.17a1 1 0 0 0 1.1.22 1 1 0 0 0 .32-.22l4.92-4.92a1 1 0 0 0-1.42-1.42l-4.92 4.92a1 1 0 0 0 0 1.42Z"></path></svg></span><span class="sr-only" data-pagefind-ignore>Section titled “See Also”</span></a></div>
<ul>
<li><a href="/ghaf/dev/guides/downstream-setup">Downstream Setup</a> - New project setup</li>
<li><a href="/ghaf/dev/guides/writing-modules">Writing Modules</a> - Module conventions</li>
<li><a href="/ghaf/dev/architecture/config-propagation">Config Propagation</a> - globalConfig/hostConfig</li>
<li><a href="/ghaf/dev/architecture/vm-composition">VM Composition</a> - extendModules pattern</li>
</ul> </div> <footer class="sl-flex astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links print:hidden astro-u2l5gyhi" dir="ltr"> <a href="/ghaf/dev/guides/downstream-setup/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg> <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Downstream Project Setup</span> </span> </a> <a href="/ghaf/dev/technologies/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg> <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Technologies</span> </span> </a> </div>   </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>